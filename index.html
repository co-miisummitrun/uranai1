<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="vQkgsiI6ESyUE4NxB11bOJWI2j2tAi0MYAKGw4ZHCb8" />
    
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://fonts.googleapis.com https://fonts.gstatic.com https://images.unsplash.com https://buy.stripe.com https://api.emailjs.com; img-src 'self' data: https://images.unsplash.com;">

    <title>ç·åˆå ã„ã‚µãƒ­ãƒ³ æ˜Ÿå±‘ã®ç¥è¨— | æœ¬æ ¼éœŠè¦–ãƒ»ã‚¿ãƒ­ãƒƒãƒˆãƒ»ç”»åƒæ‰‹ç›¸é‘‘å®š</title>
    <meta name="description" content="ãƒ—ãƒ­ã®é‘‘å®šå£«ã«ã‚ˆã‚‹æœ¬ç‰©ã®å ã„ã€‚æ¯æ—¥ã®ç„¡æ–™ã‚¿ãƒ­ãƒƒãƒˆã€é­‚ã®å¥¥åº•ã‚’é€è¦–ã™ã‚‹ãƒ„ã‚¤ãƒ³ãƒ¬ã‚¤é‘‘å®šã€æ‰‹ç›¸ã‚¹ã‚­ãƒ£ãƒ³ã€è¶…æœ¬æ ¼ã‚¿ãƒ­ãƒƒãƒˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã€‚">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Shippori+Mincho:wght@400;500;700&display=swap" rel="stylesheet">
    
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <style>
        :root {
            --gold: #d4af37; --gold-light: #f9e5b5; --gold-dark: #a67c00;
            --bg-dark: #07040a; --bg-glass: rgba(15, 10, 22, 0.85);
            --border-glow: rgba(212, 175, 55, 0.3);
            --text-main: #f0ebe1; --text-sub: #b3a8c4;
            --accent-love: #c95b7a; --accent-palm: #20b2aa; --accent-tarot: #9b59b6;
            --color-x: #000000; --color-ig: #E1306C;
            --ig-grad: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
        }
        
        body { margin: 0; padding: 0; min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; background-color: var(--bg-dark); background-image: radial-gradient(circle at 20% 30%, rgba(45, 25, 75, 0.5), transparent 50%), radial-gradient(circle at 80% 70%, rgba(20, 30, 60, 0.4), transparent 50%); font-family: 'Shippori Mincho', serif; color: var(--text-main); box-sizing: border-box; overflow-x: hidden; line-height: 1.8; background-attachment: fixed; }
        ::-webkit-scrollbar { width: 5px; } ::-webkit-scrollbar-track { background: var(--bg-dark); } ::-webkit-scrollbar-thumb { background: var(--gold-dark); border-radius: 3px; }

        .stars-bg { position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: -1; pointer-events: none; background-image: radial-gradient(1px 1px at 15% 25%, #fff, transparent), radial-gradient(1.5px 1.5px at 40% 65%, rgba(255,255,255,0.8), transparent), radial-gradient(1px 1px at 75% 35%, #fff, transparent), radial-gradient(2px 2px at 85% 85%, rgba(212,175,55,0.6), transparent); background-size: 250px 250px; animation: drift 80s linear infinite; opacity: 0.5; }
        @keyframes drift { from { transform: translateY(0); } to { transform: translateY(-250px); } }

        /* ====== ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆ ====== */
        .page-wrapper { width: 100%; max-width: 800px; padding: 40px 10px; box-sizing: border-box; display: none; animation: fadeIn 0.8s ease; }
        .page-wrapper.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        /* ====== ãƒ­ã‚°ã‚¤ãƒ³/ç™»éŒ²ãƒ¢ãƒ¼ãƒ€ãƒ« ====== */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 1000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(8px); }
        .modal-overlay.active { display: flex; animation: fadeIn 0.4s ease; }
        .modal-content { max-width: 400px; width: 90%; padding: 30px 20px; margin: 0; border-color: var(--gold); }
        .auth-tabs { display: flex; border-bottom: 1px solid rgba(255,255,255,0.1); margin-bottom: 25px; }
        .auth-tab { flex: 1; background: transparent; border: none; color: var(--text-sub); padding: 12px; cursor: pointer; font-weight: bold; letter-spacing: 2px; transition: 0.3s; font-size: 13px; font-family: inherit;}
        .auth-tab.active { color: var(--gold); border-bottom: 2px solid var(--gold); }
        .auth-form { display: none; }
        .auth-form.active { display: block; animation: fadeIn 0.4s ease; }
        .btn-cancel { background: transparent; border: none; color: var(--text-sub); text-decoration: underline; cursor: pointer; margin-top: 20px; width: 100%; font-size: 12px; letter-spacing: 1px; transition: 0.3s; font-family: inherit;}
        .btn-cancel:hover { color: #fff; }
        .error-message { color: #ff8e8e; font-size: 12px; margin-top: -15px; margin-bottom: 15px; display: none; background: rgba(255, 142, 142, 0.1); padding: 8px; border-radius: 4px; border: 1px solid rgba(255, 142, 142, 0.3); line-height: 1.4;}

        /* ====== TOPãƒšãƒ¼ã‚¸ ====== */
        .hero-section { text-align: center; padding: 20px 0 30px; }
        .hero-title-en { font-family: 'Cinzel', serif; font-size: 38px; color: var(--gold); letter-spacing: 8px; margin-bottom: 5px; text-shadow: 0 0 20px rgba(212,175,55,0.5); font-weight: 700;}
        .hero-title-ja { font-size: 22px; color: #fff; letter-spacing: 6px; margin-bottom: 20px; font-weight: 700; }
        .hero-desc { font-size: 14.5px; color: var(--text-sub); max-width: 600px; margin: 0 auto 30px; line-height: 2.2; letter-spacing: 1px; }

        .top-ig-link { display: inline-flex; align-items: center; justify-content: center; gap: 10px; margin-top: 25px; background: var(--ig-grad); color: #fff; text-decoration: none; padding: 14px 35px; border-radius: 30px; font-weight: bold; font-size: 14px; letter-spacing: 2px; box-shadow: 0 8px 20px rgba(220, 39, 67, 0.4); border: 1px solid rgba(255,255,255,0.2); transition: 0.4s; }
        .top-ig-link:hover { transform: translateY(-3px); box-shadow: 0 12px 25px rgba(220, 39, 67, 0.6); filter: brightness(1.1); }
        .top-ig-link svg { width: 18px; height: 18px; fill: currentColor; }

        .top-advisors-section { margin-bottom: 50px; }
        .sect-title { text-align: center; font-family: 'Cinzel', serif; font-size: 20px; color: var(--gold); margin-bottom: 30px; letter-spacing: 4px; border-bottom: 1px solid rgba(212,175,55,0.3); padding-bottom: 15px; display: inline-block; width: 100%;}
        .sect-title span { font-family: 'Shippori Mincho', serif; font-size: 12px; display: block; margin-top: 5px; color: var(--text-sub); letter-spacing: 2px;}
        
        .adv-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
        @media (min-width: 600px) { .adv-grid { grid-template-columns: repeat(4, 1fr); } }
        
        .adv-card { background: rgba(10,5,15,0.6); border: 1px solid rgba(255,255,255,0.05); border-radius: 12px; padding: 20px 10px; text-align: center; transition: 0.4s; box-shadow: 0 5px 15px rgba(0,0,0,0.5); position: relative; overflow: hidden; display: flex; flex-direction: column; align-items: center;}
        .adv-card::before { content:""; position:absolute; top:0; left:0; width:100%; height:3px; background: var(--gold); opacity: 0; transition: 0.4s; }
        .adv-card:hover { transform: translateY(-5px); background: rgba(20,10,30,0.8); border-color: rgba(212,175,55,0.3); box-shadow: 0 15px 30px rgba(0,0,0,0.8); }
        .adv-card:hover::before { opacity: 1; }
        
        .ac-2::before { background: var(--accent-love); } .ac-2:hover { border-color: rgba(201,91,122,0.3); }
        .ac-3::before { background: var(--accent-palm); } .ac-3:hover { border-color: rgba(32,178,170,0.3); }
        .ac-4::before { background: var(--accent-tarot); } .ac-4:hover { border-color: rgba(155,89,182,0.3); }

        .adv-img-wrap { width: 80px; height: 80px; margin: 0 auto 15px; border-radius: 50%; padding: 3px; background: linear-gradient(135deg, var(--gold), #222); box-shadow: 0 0 15px rgba(212,175,55,0.2); }
        .ac-2 .adv-img-wrap { background: linear-gradient(135deg, var(--accent-love), #222); box-shadow: 0 0 15px rgba(201,91,122,0.2); }
        .ac-3 .adv-img-wrap { background: linear-gradient(135deg, var(--accent-palm), #222); box-shadow: 0 0 15px rgba(32,178,170,0.2); }
        .ac-4 .adv-img-wrap { background: linear-gradient(135deg, var(--accent-tarot), #222); box-shadow: 0 0 15px rgba(155,89,182,0.2); }
        
        .adv-img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; background: #111;}
        .adv-card-role { font-size: 10px; color: var(--gold); letter-spacing: 1px; margin-bottom: 5px; font-weight: bold;}
        .ac-2 .adv-card-role { color: var(--accent-love); } .ac-3 .adv-card-role { color: var(--accent-palm); } .ac-4 .adv-card-role { color: var(--accent-tarot); }
        .adv-card-name { font-size: 14px; color: #fff; font-weight: bold; letter-spacing: 1px; margin-bottom: 5px;}
        .adv-card-desc { font-size: 11px; color: var(--text-sub); margin-top: 8px; line-height: 1.7; text-align: left; border-top: 1px dashed rgba(255,255,255,0.1); padding-top: 12px; width: 100%;}

        .enter-btn-wrap { text-align: center; padding: 10px 0 50px; display: flex; flex-direction: column; align-items: center;}
        .enter-btn { display: inline-block; padding: 22px 60px; font-size: 17px; font-weight: 700; letter-spacing: 4px; color: #000; background: linear-gradient(135deg, var(--gold-dark), var(--gold-light), var(--gold-dark)); background-size: 200% auto; border: none; border-radius: 50px; cursor: pointer; transition: 0.5s; box-shadow: 0 10px 30px rgba(212,175,55,0.4); text-decoration: none; font-family: inherit; }
        .enter-btn:hover { background-position: right center; transform: scale(1.05); box-shadow: 0 15px 40px rgba(212,175,55,0.6); }

        /* ====== å ã„ã‚¢ãƒ—ãƒªç”»é¢ ====== */
        .tab-container { display: flex; width: 100%; margin-bottom: 20px; background: rgba(0,0,0,0.6); border-radius: 8px; border: 1px solid rgba(255,255,255,0.05); overflow: hidden; backdrop-filter: blur(10px); box-shadow: 0 10px 30px rgba(0,0,0,0.8); }
        .tab-btn { flex: 1; padding: 12px 0; text-align: center; cursor: pointer; font-size: 12px; font-weight: 600; color: var(--text-sub); background: transparent; border: none; border-right: 1px solid rgba(255,255,255,0.05); transition: 0.4s; letter-spacing: 1px; }
        .tab-btn:last-child { border-right: none; }
        .tab-btn:hover { color: var(--gold-light); background: rgba(255,255,255,0.05); }
        .tab-btn span { font-size: 9px; font-weight: normal; display: block; margin-top: 2px;}
        
        .tab-btn.active.t-daily { color: var(--gold); background: linear-gradient(180deg, rgba(212,175,55,0.15) 0%, transparent 100%); border-bottom: 2px solid var(--gold);}
        .tab-btn.active.t-destiny { color: var(--accent-love); background: linear-gradient(180deg, rgba(201,91,122,0.15) 0%, transparent 100%); border-bottom: 2px solid var(--accent-love);}
        .tab-btn.active.t-palm { color: var(--accent-palm); background: linear-gradient(180deg, rgba(32,178,170,0.15) 0%, transparent 100%); border-bottom: 2px solid var(--accent-palm);}
        .tab-btn.active.t-tarot { color: var(--accent-tarot); background: linear-gradient(180deg, rgba(155,89,182,0.15) 0%, transparent 100%); border-bottom: 2px solid var(--accent-tarot);}

        .glass-panel { background: var(--bg-glass); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px); border: 1px solid rgba(255,255,255,0.08); border-top: 1px solid var(--border-glow); border-radius: 12px; padding: 35px 25px; width: 100%; margin-bottom: 40px; box-shadow: 0 25px 50px rgba(0,0,0,0.9), inset 0 0 20px rgba(212,175,55,0.05); box-sizing: border-box; }

        .advisor-profile { display: flex; flex-direction: column; align-items: center; text-align: center; margin-bottom: 30px; padding-bottom: 25px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .advisor-photo-wrapper { position: relative; width: 110px; height: 110px; margin-bottom: 20px; border-radius: 50%; padding: 3px; background: linear-gradient(135deg, var(--gold), #222); box-shadow: 0 0 30px rgba(212,175,55,0.2); transition: 0.5s; flex-shrink: 0;}
        .advisor-photo { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; background: #111; }
        .advisor-role { font-family: 'Cinzel', serif; font-size: 11px; color: var(--gold); margin-bottom: 5px; letter-spacing: 3px; text-transform: uppercase; transition: 0.3s;}
        .advisor-name { font-size: 18px; color: #fff; font-weight: 700; margin-bottom: 10px; letter-spacing: 2px; }
        .advisor-bio { font-size: 13px; color: var(--text-sub); line-height: 1.8; text-align: justify; max-width: 500px; }
        @media (min-width: 550px) { .advisor-profile { flex-direction: row; text-align: left; align-items: center; } .advisor-photo-wrapper { margin-bottom: 0; margin-right: 25px; } }

        .site-title { font-family: 'Cinzel', serif; font-size: 26px; color: var(--gold); margin: 0 0 5px; text-align: center; letter-spacing: 5px; font-weight: 600; }
        .site-title-ja { font-size: 18px; color: #fff; text-align: center; margin: 0 0 5px; letter-spacing: 4px; font-weight: 600; }
        .site-subtitle { font-size: 11px; color: var(--text-sub); margin-bottom: 30px; text-align: center; letter-spacing: 2px; }

        .form-group { margin-bottom: 20px; text-align: left;}
        label { display: block; margin-bottom: 8px; font-size: 12.5px; color: var(--gold-light); letter-spacing: 1.5px; font-weight: bold;}
        .input-row { display: flex; gap: 10px; } .input-row > div { flex: 1; }
        input[type="text"], input[type="email"], input[type="password"], input[type="date"], select, textarea { width: 100%; padding: 14px; background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.15); border-radius: 6px; color: #fff; font-size: 14px; font-family: inherit; transition: 0.3s; color-scheme: dark; box-sizing: border-box;}
        textarea { resize: vertical; min-height: 90px; }
        select { appearance: none; background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2214%22%20height%3D%2214%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%23d4af37%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpolyline%20points%3D%226%209%2012%2015%2018%209%22%3E%3C%2Fpolyline%3E%3C%2Fsvg%3E"); background-repeat: no-repeat; background-position: right 15px center; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: var(--gold); box-shadow: 0 0 15px rgba(212,175,55,0.3); background: rgba(0,0,0,0.7); }

        .upload-box { position: relative; border: 2px dashed rgba(32,178,170,0.4); border-radius: 8px; padding: 25px 15px; text-align: center; background: rgba(0,0,0,0.3); transition: 0.3s; cursor: pointer; overflow: hidden; margin-bottom: 10px;}
        .upload-box:hover { border-color: var(--accent-palm); background: rgba(32,178,170,0.05); }
        .upload-box input[type="file"] { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer; }
        .upload-text { color: #fff; font-size: 13px; margin: 10px 0 5px; font-weight: bold; letter-spacing: 1px;}
        
        .preview-container { display: none; margin-top: 15px; position: relative; width: 100%; max-width: 280px; margin-left: auto; margin-right: auto; border-radius: 8px; overflow: hidden; border: 1px solid var(--accent-palm); box-shadow: 0 0 20px rgba(32,178,170,0.3); background: #000;}
        .preview-img { width: 100%; display: block; filter: contrast(1.1); }
        .preview-actions { text-align: center; padding: 10px; background: rgba(0,0,0,0.5); }
        .btn-change-img { background: transparent; border: 1px solid var(--accent-palm); color: var(--accent-palm); padding: 6px 15px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: 0.3s;}

        button.main-btn { width: 100%; padding: 18px; margin-top: 10px; background: linear-gradient(135deg, var(--gold-dark), var(--gold-light), var(--gold-dark)); background-size: 200% auto; color: #000; font-family: inherit; font-size: 14px; font-weight: 700; border: none; border-radius: 6px; cursor: pointer; letter-spacing: 3px; transition: 0.5s; box-shadow: 0 5px 20px rgba(0,0,0,0.6); text-transform: uppercase; }
        button.main-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        button.main-btn:hover:not(:disabled) { background-position: right center; box-shadow: 0 0 25px rgba(212,175,55,0.6); transform: translateY(-2px); }
        button.love-btn { background: linear-gradient(135deg, #8a2846, #c95b7a, #8a2846); color: #fff; } button.love-btn:hover:not(:disabled) { box-shadow: 0 0 25px rgba(201, 91, 122, 0.6); }
        button.palm-btn { background: linear-gradient(135deg, #0f524e, #20b2aa, #0f524e); color: #fff; } button.palm-btn:hover:not(:disabled) { box-shadow: 0 0 25px rgba(32, 178, 170, 0.6); }
        button.tarot-btn { background: linear-gradient(135deg, #4b0082, #9b59b6, #4b0082); color: #fff; } button.tarot-btn:hover:not(:disabled) { box-shadow: 0 0 25px rgba(155, 89, 182, 0.6); }

        .content-area { display: none; animation: fadeUp 0.6s cubic-bezier(0.2, 0.8, 0.2, 1); }
        .content-area.active { display: block; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ¼”å‡º */
        #loading { display: none; padding: 60px 0; text-align: center; }
        .mystic-wheel { width: 90px; height: 90px; margin: 0 auto 25px; border: 1px dashed rgba(212,175,55,0.5); border-top: 2px solid var(--gold); border-bottom: 2px solid var(--gold); border-radius: 50%; position: relative; animation: spin 3s linear infinite; }
        .mystic-wheel::after { content: "âœ§"; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: var(--gold); font-size: 35px; animation: pulse 1.5s infinite alternate;}
        
        .scan-container { position: relative; width: 200px; height: 260px; margin: 0 auto 25px; border-radius: 12px; overflow: hidden; border: 1px solid rgba(32,178,170,0.5); background: #000; display: none; box-shadow: 0 0 30px rgba(32,178,170,0.2); }
        .scan-target-img { width: 100%; height: 100%; object-fit: cover; opacity: 0.5; filter: contrast(1.3) grayscale(0.5); }
        .scanner-line { position: absolute; top: 0; left: 0; width: 100%; height: 3px; background: var(--accent-palm); box-shadow: 0 0 15px 5px rgba(32,178,170,0.6); z-index: 5; animation: scanMove 2s ease-in-out infinite alternate; display: none;}
        .scan-grid { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: linear-gradient(rgba(32,178,170,0.2) 1px, transparent 1px), linear-gradient(90deg, rgba(32,178,170,0.2) 1px, transparent 1px); background-size: 20px 20px; z-index: 2; pointer-events: none; }
        
        @keyframes spin { 100% { transform: rotate(360deg); } } @keyframes pulse { 100% { opacity: 0.4; transform: translate(-50%, -50%) scale(0.8); } } @keyframes scanMove { 0% { top: 0%; } 100% { top: 100%; } }
        .loading-text { font-family: 'Cinzel', serif; color: var(--gold); font-size: 14px; letter-spacing: 3px; font-weight: 600; animation: blink 1.5s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        /* çµæœç”»é¢å…±é€š */
        .result-header { text-align: center; margin-bottom: 30px; }
        .result-name { font-size: 22px; color: #fff; font-weight: 700; letter-spacing: 2px; margin-bottom: 10px; }
        .result-meta { font-size: 12px; color: var(--gold); letter-spacing: 2px; font-family: 'Cinzel', serif; }

        .story-card { background: rgba(5,3,10,0.6); border: 1px solid rgba(255,255,255,0.05); border-radius: 8px; overflow: hidden; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.6); }
        .story-img { width: 100%; height: 160px; object-fit: cover; opacity: 0.85; border-bottom: 1px solid rgba(212,175,55,0.2); }
        .love-theme .story-img { border-bottom-color: rgba(201,91,122,0.3); } .palm-theme .story-img { border-bottom-color: rgba(32,178,170,0.3); } .tarot-theme .story-img { border-bottom-color: rgba(155,89,182,0.3); }
        
        .story-content { padding: 25px 20px; position: relative; }
        .story-title { font-size: 16px; color: var(--gold); margin-bottom: 15px; font-weight: 700; letter-spacing: 1px; border-left: 3px solid var(--gold); padding-left: 12px; }
        .love-theme .story-title { color: var(--accent-love); border-left-color: var(--accent-love); } .palm-theme .story-title { color: var(--accent-palm); border-left-color: var(--accent-palm); } .tarot-theme .story-title { color: var(--accent-tarot); border-left-color: var(--accent-tarot); }
        
        .story-text { font-size: 14.5px; line-height: 2.1; color: #eaeaeb; text-align: justify; word-wrap: break-word; overflow-wrap: break-word;} .story-text p { margin: 0 0 18px 0; } .story-text p:last-child { margin: 0; }
        
        .highlight { color: #fff; font-weight: 700; background: linear-gradient(transparent 65%, rgba(212,175,55,0.4) 65%); }
        .love-highlight { color: #fff; font-weight: 700; background: linear-gradient(transparent 65%, rgba(201,91,122,0.5) 65%); }
        .palm-highlight { color: #fff; font-weight: 700; background: linear-gradient(transparent 65%, rgba(32,178,170,0.4) 65%); }
        .tarot-highlight { color: #fff; font-weight: 700; background: linear-gradient(transparent 65%, rgba(155,89,182,0.4) 65%); }
        .alert-text { color: #ff8e8e; font-weight: 700; border-bottom: 1px dashed #ff8e8e; }
        
        /* ğŸ’° èª²é‡‘ãƒšã‚¤ã‚¦ã‚©ãƒ¼ãƒ« */
        .premium-wrapper { position: relative; border-radius: 8px; margin-bottom: 30px; border: 1px solid var(--gold); background: rgba(5,3,10,0.6); box-shadow: 0 10px 30px rgba(0,0,0,0.6); overflow: hidden;}
        .premium-wrapper.locked .premium-blur-target { filter: blur(5px); opacity: 0.4; user-select: none; pointer-events: none; }
        .paywall-overlay { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, rgba(5,3,10,0) 0%, rgba(5,3,10,0.95) 40%, rgba(5,3,10,1) 100%); flex-direction: column; align-items: center; justify-content: flex-end; padding: 30px 20px; z-index: 5; text-align: center; box-sizing: border-box;}
        .premium-wrapper.locked .paywall-overlay { display: flex; }
        .premium-wrapper.unlocked .paywall-overlay { display: none; }
        .premium-wrapper.unlocked .premium-blur-target { filter: none; opacity: 1; pointer-events: auto; user-select: auto; }
        .paywall-btn { background: linear-gradient(135deg, var(--gold-dark), var(--gold-light), var(--gold-dark)); color: #000; border: none; padding: 16px 35px; border-radius: 30px; font-weight: bold; cursor: pointer; transition: 0.3s; letter-spacing: 1px; font-size: 14px; box-shadow: 0 5px 15px rgba(212,175,55,0.4); text-decoration: none; font-family: inherit;}
        .paywall-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(212,175,55,0.6); }
        .love-theme .premium-wrapper { border-color: var(--accent-love); } .love-theme .paywall-btn { background: linear-gradient(135deg, #8a2846, #c95b7a, #8a2846); color: #fff; box-shadow: 0 5px 15px rgba(201,91,122,0.4);}
        .palm-theme .premium-wrapper { border-color: var(--accent-palm); } .palm-theme .paywall-btn { background: linear-gradient(135deg, #0f524e, #20b2aa, #0f524e); color: #fff; box-shadow: 0 5px 15px rgba(32,178,170,0.4);}
        .tarot-theme .premium-wrapper { border-color: var(--accent-tarot); } .tarot-theme .paywall-btn { background: linear-gradient(135deg, #4b0082, #9b59b6, #4b0082); color: #fff; box-shadow: 0 5px 15px rgba(155,89,182,0.4);}

        /* ğŸƒ ã‚¿ãƒ­ãƒƒãƒˆ3Dãƒ•ãƒªãƒƒãƒ— */
        .tarot-spread { display: flex; gap: 8px; margin-bottom: 30px; justify-content: center; }
        .t-card-wrap { flex: 1; perspective: 1000px; display: flex; flex-direction: column; align-items: center;}
        .t-label { font-size: 11px; color: var(--text-sub); margin-bottom: 8px; letter-spacing: 1px; font-weight: bold;}
        .t-card-inner { width: 100%; max-width: 130px; aspect-ratio: 2/3; position: relative; transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform-style: preserve-3d; }
        .t-card-inner.flipped { transform: rotateY(180deg); }
        .t-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 8px; border: 1px solid rgba(155,89,182,0.4); box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .t-back { background: radial-gradient(circle at center, #2a1545, #110522); border: 2px solid var(--accent-tarot); display: flex; align-items: center; justify-content: center; font-size: 30px; color: var(--accent-tarot); }
        .t-front { transform: rotateY(180deg); background: linear-gradient(135deg, rgba(20,10,35,0.9), rgba(0,0,0,0.9)); display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 10px; text-align: center;}
        .t-front-num { font-family: 'Cinzel', serif; font-size: 22px; color: var(--gold); margin-bottom: 5px; }
        .t-front-name { font-size: 13px; font-weight: bold; color: #fff; margin-bottom: 8px; line-height: 1.3;}
        .t-front-pos { font-size: 10px; padding: 2px 8px; border-radius: 10px; font-weight: bold; letter-spacing: 1px;}
        .t-pos-up { background: rgba(212,175,55,0.2); color: var(--gold-light); border: 1px solid var(--gold); }
        .t-pos-rev { background: rgba(201,91,122,0.2); color: #ffb3c6; border: 1px solid var(--accent-love); box-shadow: 0 0 10px rgba(201,91,122,0.4);}

        /* ğŸ“± SNSã‚·ã‚§ã‚¢ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .share-section { margin-top: 40px; padding-top: 30px; border-top: 1px dashed rgba(255,255,255,0.1); text-align: center; }
        .share-title { font-size: 13px; color: var(--gold-light); margin-bottom: 20px; letter-spacing: 2px; font-weight: bold;}
        .share-buttons { display: flex; gap: 15px; justify-content: center; margin-bottom: 25px; flex-wrap: wrap;}
        .sns-btn { display: flex; align-items: center; justify-content: center; gap: 8px; padding: 14px 20px; border-radius: 30px; font-size: 13px; font-weight: bold; letter-spacing: 1px; color: #fff; text-decoration: none; transition: 0.3s; cursor: pointer; border: none; min-width: 170px; font-family: inherit;}
        .sns-btn svg { width: 16px; height: 16px; fill: currentColor; }
        .btn-x { background-color: var(--color-x); border: 1px solid rgba(255,255,255,0.2); box-shadow: 0 4px 10px rgba(0,0,0,0.5);}
        .btn-x:hover { background-color: #222; transform: translateY(-2px); box-shadow: 0 6px 15px rgba(255,255,255,0.2); }
        .btn-ig { background: var(--ig-grad); box-shadow: 0 4px 10px rgba(225, 48, 108, 0.3); border: 1px solid rgba(255,255,255,0.2);}
        .btn-ig:hover { filter: brightness(1.1); transform: translateY(-2px); box-shadow: 0 6px 15px rgba(225, 48, 108, 0.5);}

        .btn-retry { width: 100%; padding: 18px; background: rgba(0,0,0,0.3); border: 1px solid rgba(212,175,55,0.4); color: var(--gold); border-radius: 6px; cursor: pointer; font-size: 14px; transition: 0.4s; margin-top: 10px; letter-spacing: 3px; text-transform: uppercase; font-weight: 600; }
        .btn-retry:hover { background: rgba(212,175,55,0.15); color: #fff; box-shadow: 0 0 20px rgba(212,175,55,0.2); }
        .love-theme .btn-retry { border-color: rgba(201,91,122,0.5); color: var(--accent-love); } .love-theme .btn-retry:hover { background: rgba(201,91,122,0.15); }
        .palm-theme .btn-retry { border-color: rgba(32,178,170,0.5); color: var(--accent-palm); } .palm-theme .btn-retry:hover { background: rgba(32,178,170,0.15); }
        .tarot-theme .btn-retry { border-color: rgba(155,89,182,0.5); color: var(--accent-tarot); } .tarot-theme .btn-retry:hover { background: rgba(155,89,182,0.15); }
        
        /* ãƒœãƒˆãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */
        .bottom-actions { text-align: center; margin-top: 25px; display: flex; flex-direction: column; gap: 15px; align-items: center;}
        .btn-home { background: transparent; border: none; color: var(--text-sub); cursor: pointer; font-size: 13px; text-decoration: underline; transition: 0.3s; letter-spacing: 1px; font-family: inherit;}
        .btn-home:hover { color: #fff; }
        .btn-setting { border: 1px solid rgba(255,255,255,0.3); color: var(--text-sub); padding: 10px 20px; border-radius: 30px; text-decoration: none; cursor: pointer; font-size: 12px; transition: 0.3s; background: transparent; font-family: inherit;}
        .btn-setting:hover { background: rgba(255, 255, 255, 0.1); color: #fff; }
        .btn-logout { border: 1px solid #ff8e8e; color: #ff8e8e; padding: 10px 20px; border-radius: 30px; text-decoration: none; cursor: pointer; font-size: 12px; transition: 0.3s; background: transparent; font-family: inherit;}
        .btn-logout:hover { background: rgba(255, 142, 142, 0.1); color: #fff; }
        .action-row { display: flex; justify-content: center; gap: 15px; }
    </style>
</head>
<body>

<div class="stars-bg"></div>

<div id="authModal" class="modal-overlay">
    <div class="glass-panel modal-content">
        <div class="site-title" style="font-size: 22px;">ASTRAL SANCTUARY</div>
        
        <div class="auth-tabs" id="authTabs">
            <button class="auth-tab active" onclick="switchAuthTab('login')">ãƒ­ã‚°ã‚¤ãƒ³</button>
            <button class="auth-tab" onclick="switchAuthTab('register')">æ–°è¦ç™»éŒ²</button>
        </div>
        
        <div id="auth-login" class="auth-form active">
            <p class="site-subtitle" style="margin-bottom: 20px;">ã‚ãªãŸå°‚ç”¨ã®é­‚ã®è¨˜éŒ²ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚</p>
            <p id="loginAlert" class="error-message"></p>
            <div class="form-group"><label>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label><input type="email" id="loginEmail" placeholder="ä¾‹: user@example.com" maxlength="100"></div>
            <div class="form-group"><label>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label><input type="password" id="loginPass" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›" maxlength="50"></div>
            
            <div class="form-group" id="adminPinGroup" style="display:none;">
                <label style="color: #ff8e8e;">ğŸ”‘ ç®¡ç†è€…ç”¨äºŒæ®µéšèªè¨¼ã‚³ãƒ¼ãƒ‰ (PIN)</label>
                <input type="password" id="loginAdminPin" placeholder="ç®¡ç†è€…PINã‚’å…¥åŠ›" style="border-color: #ff8e8e;" maxlength="10">
            </div>

            <button class="main-btn" onclick="doLogin()" style="padding: 14px;">ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦é€²ã‚€</button>
        </div>

        <div id="auth-register" class="auth-form">
            <p class="site-subtitle" style="margin-bottom: 20px;">æ–°ã—ãé­‚ã®è¨˜éŒ²ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
            <div class="form-group"><label>ãŠåå‰</label><input type="text" id="regName" placeholder="ä¾‹: æ˜Ÿé‡ çµè¡£" maxlength="30"></div>
            <div class="form-group"><label>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label><input type="email" id="regEmail" placeholder="ä¾‹: user@example.com" maxlength="100"></div>
            <div class="form-group"><label>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label><input type="password" id="regPass" placeholder="4æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›" maxlength="50"></div>
            <button class="main-btn" id="btnSendVerify" onclick="sendVerification()" style="padding: 14px;">èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡</button>
        </div>

        <div id="auth-verify" class="auth-form">
            <p class="site-subtitle" style="margin-bottom: 20px; color: var(--gold-light);">èªè¨¼ã‚³ãƒ¼ãƒ‰ã®ç¢ºèª</p>
            <p id="verifyGuide" style="font-size: 12.5px; color: var(--text-sub); text-align: left; margin-bottom: 15px; line-height: 1.8;">
                ã”å…¥åŠ›ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å®›ã«ã€ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰6æ¡ã®èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚ï¼ˆâ€»è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ãƒ•ã‚©ãƒ«ãƒ€ã‚‚ã”ç¢ºèªãã ã•ã„ï¼‰
            </p>
            
            <div class="form-group"><label>èªè¨¼ã‚³ãƒ¼ãƒ‰</label><input type="text" id="verifyCode" placeholder="6æ¡ã®æ•°å­—ã‚’å…¥åŠ›" maxlength="6"></div>
            <button class="main-btn" onclick="verifyEmail()" style="padding: 14px;">èªè¨¼ã—ã¦ç™»éŒ²å®Œäº†</button>
        </div>
        
        <button class="btn-cancel" onclick="closeAuthModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¦æˆ»ã‚‹</button>
    </div>
</div>

<div id="passModal" class="modal-overlay">
    <div class="glass-panel modal-content">
        <div class="site-title" style="font-size: 20px;">ACCOUNT SETTING</div>
        <h2 class="site-title-ja" style="font-size: 18px; margin-bottom:20px;">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´</h2>
        
        <div class="form-group"><label>ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label><input type="password" id="oldPass" placeholder="ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" maxlength="50"></div>
        <div class="form-group"><label>æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label><input type="password" id="newPass" placeholder="4æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›" maxlength="50"></div>
        <button class="main-btn" onclick="changePassword()" style="padding: 14px;">å¤‰æ›´ã‚’ä¿å­˜ã™ã‚‹</button>
        <button class="btn-cancel" onclick="closePassModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
    </div>
</div>

<div id="page-home" class="page-wrapper active">
    
    <div class="hero-section">
        <div class="hero-title-en">ASTRAL SANCTUARY</div>
        <div class="hero-title-ja">æ˜Ÿå±‘ã®ç¥è¨— - ç·åˆå ã„ã‚µãƒ­ãƒ³ -</div>
        <div class="hero-desc">
            é‹å‘½ã¯æ±ºã¾ã£ã¦ã„ã‚‹ã‚‚ã®ã§ã¯ãªãã€è‡ªã‚‰é¸ã³å–ã‚‹ã‚‚ã®ã€‚<br>
            å½“ã‚µãƒ­ãƒ³ã§ã¯ã€å³ã—ã„ä¿®è¡Œã‚’ç©ã‚“ã 4åã®ç‰¹åˆ¥é‘‘å®šå£«ãŒã€<br>
            ã‚ãªãŸã®é­‚ã®è»Œè·¡ã‚’èª­ã¿è§£ãã€çœŸå®Ÿã®æ„›ã¨æœªæ¥ã¸ã®é“æ¨™ã‚’æç¤ºã—ã¾ã™ã€‚
        </div>
    </div>

    <div class="top-advisors-section">
        <div class="sect-title">OUR ASTROLOGERS<span>- æ‰€å±ç‰¹åˆ¥é‘‘å®šå£« -</span></div>
        <div class="adv-grid">
            <div class="adv-card ac-1">
                <div class="adv-img-wrap"><img src="image.png" class="adv-img" onerror="this.src='https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&fit=crop'"></div>
                <div class="adv-card-role">Astrology</div>
                <div class="adv-card-name">æ˜Ÿå° ãƒ«ãƒŸãƒŠ</div>
                <div class="adv-card-desc">è¥¿æ´‹å æ˜Ÿè¡“ã¨ã‚¿ãƒ­ãƒƒãƒˆã‚’çµ±åˆã—ã€é‹å‘½ã‚’å¥½è»¢ã•ã›ã‚‹å…·ä½“çš„ãªé“æ¨™ã‚’æç¤ºã—ã¾ã™ã€‚</div>
            </div>
            <div class="adv-card ac-2">
                <div class="adv-img-wrap"><img src="image2.png" class="adv-img" onerror="this.src='https://images.unsplash.com/photo-1517841905240-472988babdf9?w=150&fit=crop'"></div>
                <div class="adv-card-role">Twin Ray</div>
                <div class="adv-card-name">å¤©éœ§ çµç¥ˆ</div>
                <div class="adv-card-desc">é¡ã¾ã‚ŒãªéœŠè¦–èƒ½åŠ›ã§ã€é­‚ãƒ¬ãƒ™ãƒ«ã§æƒ¹ã‹ã‚Œåˆã†ã€Œæœ¬å½“ã®é‹å‘½ã®ç›¸æ‰‹ã€ã‚’ç‰¹å®šã—ã¾ã™ã€‚</div>
            </div>
            <div class="adv-card ac-3">
                <div class="adv-img-wrap"><img src="image3.png" class="adv-img" onerror="this.src='https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=150&fit=crop'"></div>
                <div class="adv-card-role">Mystic Palm</div>
                <div class="adv-card-name">ç¥å®®å¯º å¸</div>
                <div class="adv-card-desc">ç”»åƒè§£æã¨å¤ä»£æ‰‹ç›¸å­¦ã‚’èåˆã—ã€æŒã«åˆ»ã¾ã‚ŒãŸç„¡æ„è­˜ã®æ‰èƒ½ã¨æœªæ¥ã‚’èª­ã¿è§£ãã¾ã™ã€‚</div>
            </div>
            <div class="adv-card ac-4">
                <div class="adv-img-wrap"><img src="image4.png" class="adv-img" onerror="this.src='https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=150&fit=crop'"></div>
                <div class="adv-card-role">Tarot Reader</div>
                <div class="adv-card-name">ç¥ä»£ ã‚¢ãƒªã‚¹</div>
                <div class="adv-card-desc">å¤§ã‚¢ãƒ«ã‚«ãƒŠã®æ³¢å‹•ã‚’æ“ã‚Šã€ã‚ãªãŸã®æ‚©ã¿ã«å¯„ã‚Šæ·»ã†å€‹åˆ¥ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ç´¡ãå‡ºã—ã¾ã™ã€‚</div>
            </div>
        </div>
    </div>

    <div class="enter-btn-wrap">
        <button class="enter-btn" id="topEnterBtn" onclick="enterSanctuary()">å ã£ã¦ã¿ã‚‹ï¼</button>
        <br><br>
        <a href="https://www.instagram.com/ruminauranai/" target="_blank" class="top-ig-link" rel="noopener noreferrer">
            <svg viewBox="0 0 448 512" width="18" height="18" fill="currentColor"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>
            å…¬å¼Instagramã¯ã“ã¡ã‚‰
        </a>
    </div>

</div>

<div id="page-app" class="page-wrapper">

    <div class="tab-container" id="tab-menu">
        <button class="tab-btn active t-daily" onclick="switchTab('daily')">DAILY<br><span>ä»Šæ—¥ã®é‹å‹¢</span></button>
        <button class="tab-btn t-destiny" onclick="switchTab('destiny')">TWIN RAY<br><span>é‹å‘½ã®ç›¸æ‰‹</span></button>
        <button class="tab-btn t-palm" onclick="switchTab('palm')">PALM<br><span>ç¥ç§˜ã®æ‰‹ç›¸é€è¦–</span></button>
        <button class="tab-btn t-tarot" onclick="switchTab('tarot')">TAROT<br><span>æœ¬æ ¼ã‚¿ãƒ­ãƒƒãƒˆ</span></button>
    </div>

    <div class="glass-panel">
        
        <div class="advisor-profile" id="profile-area">
            <div class="advisor-photo-wrapper" id="advPhotoWrap"><img id="advPhoto" src="image.png" alt="å ã„å¸«" class="advisor-photo"></div>
            <div class="advisor-info">
                <div class="advisor-role" id="advRole">Astrology & Tarot</div>
                <div class="advisor-name" id="advName">æ˜Ÿå° ãƒ«ãƒŸãƒŠ</div>
                <div class="advisor-bio" id="advBio">ä»£ã€…ç¶šãæ˜Ÿèª­ã¿ã®å®¶ç³»ã«ç”Ÿã¾ã‚Œã€è¥¿æ´‹å æ˜Ÿè¡“ã¨ã‚¿ãƒ­ãƒƒãƒˆã‚’çµ±åˆã€‚ã‚ãªãŸã®é­‚ã«åˆ»ã¾ã‚ŒãŸéå»ãƒ»ç¾åœ¨ãƒ»æœªæ¥ã®è¨˜éŒ²ã‚’èª­ã¿è§£ãã€é‹å‘½ã‚’å¥½è»¢ã•ã›ã‚‹å…·ä½“çš„ãªé“æ¨™ã‚’æç¤ºã—ã¾ã™ã€‚</div>
            </div>
        </div>

        <div id="form-daily" class="content-area active">
            <div class="site-title">ASTRAL ORACLE</div><h1 class="site-title-ja">æ˜Ÿå±‘ã®ç¥è¨—</h1>
            <p class="site-subtitle">ã€œ æ˜Ÿã®é…ç½®ã¨ãƒ¯ãƒ³ã‚ªãƒ©ã‚¯ãƒ«ãŒå‘Šã’ã‚‹ä»Šæ—¥ã®é‹å‘½ ã€œ</p>
            <div class="form-group"><label>ãŠåå‰ (NAME)</label><input type="text" id="name1" placeholder="ä¾‹ï¼šæ˜Ÿé‡ çµè¡£" autocomplete="off" maxlength="30"></div>
            <div class="form-group"><label>ç”Ÿå¹´æœˆæ—¥ (BIRTH DATE)</label><input type="date" id="dob1" class="date-input"></div>
            <button class="main-btn" onclick="startDailyOracle()">é‹å‘½ã®ã‚«ãƒ¼ãƒ‰ã‚’å¼•ãï¼ˆå®Œå…¨ç„¡æ–™ï¼‰</button>
        </div>

        <div id="form-destiny" class="content-area">
            <div class="site-title" style="color:var(--accent-love);">TRUE DESTINY</div><h1 class="site-title-ja">é‹å‘½ã®ç›¸æ‰‹ãƒ»æ·±å±¤éœŠè¦–</h1>
            <p class="site-subtitle">ã€œ é­‚ãƒ¬ãƒ™ãƒ«ã§æƒ¹ã‹ã‚Œåˆã†ã€ŒçœŸå®Ÿã®ä¼´ä¾¶ã€ã‚’ç‰¹å®š ã€œ</p>
            <div class="form-group"><label>ãŠåå‰ (NAME)</label><input type="text" id="name2" placeholder="ä¾‹ï¼šæœˆåŸ è“®" autocomplete="off" maxlength="30"></div>
            <div class="input-row">
                <div class="form-group"><label>æ€§åˆ¥</label><select id="gender2"><option value="female">å¥³æ€§</option><option value="male">ç”·æ€§</option><option value="other">ãã®ä»–</option></select></div>
                <div class="form-group"><label>è¡€æ¶²å‹</label><select id="blood2"><option value="A">Aå‹</option><option value="B">Bå‹</option><option value="O">Oå‹</option><option value="AB">ABå‹</option><option value="unknown">ä¸æ˜</option></select></div>
            </div>
            <div class="form-group"><label>ç”Ÿå¹´æœˆæ—¥</label><input type="date" id="dob2" class="date-input"></div>
            <div class="form-group">
                <label>ç¾åœ¨ã®ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼çŠ¶æ³ â€»é‘‘å®šçµæœãŒå¤§ããåˆ†å²ã™ã‚‹é‡è¦é …ç›®ã§ã™</label>
                <select id="status2" style="border-color: rgba(201,91,122,0.4);">
                    <option value="single">ç¾åœ¨ãƒ•ãƒªãƒ¼ï¼ˆé‹å‘½ã®å‡ºä¼šã„ã‚’æ±‚ã‚ã¦ã„ã‚‹ï¼‰</option>
                    <option value="partner">ç¾åœ¨ã€æ‹äººã‚„é…å¶è€…ï¼ˆæ—¦é‚£ãƒ»å¦»ï¼‰ãŒã„ã‚‹</option>
                    <option value="complicated">è¤‡é›‘ãªé–¢ä¿‚ï¼ˆç‰‡æ€ã„ãƒ»ä¸å€«ãƒ»èª°ã«ã‚‚è¨€ãˆãªã„é–¢ä¿‚ãªã©ï¼‰</option>
                </select>
            </div>
            <button class="main-btn love-btn" onclick="startDestinyOracle()">é­‚ã®æ·±å±¤ã«æ¥ç¶šã™ã‚‹</button>
        </div>

        <div id="form-palm" class="content-area">
            <div class="site-title" style="color:var(--accent-palm);">MYSTIC PALM READING</div><h1 class="site-title-ja">ç¥ç§˜ã®ç”»åƒæ‰‹ç›¸é€è¦–</h1>
            <p class="site-subtitle">ã€œ ã‚ãªãŸã®æŒã«åˆ»ã¾ã‚ŒãŸæ‰èƒ½ã¨æœªæ¥ã®é‹å‘½ã‚’èª­ã¿è§£ã ã€œ</p>
            <div class="form-group"><label>ãŠåå‰ (NAME)</label><input type="text" id="name3" placeholder="ä¾‹ï¼šå¤©æµ· ç¿”" autocomplete="off" maxlength="30"></div>
            <div class="form-group"><label>ç”Ÿå¹´æœˆæ—¥ (BIRTH DATE)</label><input type="date" id="dob3" class="date-input"></div>
            <div class="form-group">
                <label>æ‰‹ã®ã²ã‚‰ã®å†™çœŸã‚’æ’®å½±ï¼ˆã¾ãŸã¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠï¼‰</label>
                <div class="upload-box" id="uploadBox">
                    <input type="file" id="palmImage" accept=".jpg, .jpeg, .png, .gif, .webp, image/jpeg, image/png, image/gif, image/webp" capture="environment" onchange="previewPalmImage(event)">
                    <div style="font-size:30px; margin-bottom:5px;">ğŸ“·</div>
                    <div class="upload-text">ã‚¿ãƒƒãƒ—ã—ã¦ã‚«ãƒ¡ãƒ©ã‚’èµ·å‹• / å†™çœŸã‚’é¸æŠ</div>
                    <div style="font-size:11px; color:var(--text-sub);">â€»æ˜ã‚‹ã„å ´æ‰€ã§ã€æ‰‹ã®ã²ã‚‰å…¨ä½“ãŒå†™ã‚‹ã‚ˆã†ã«æ’®å½±ã—ã¦ãã ã•ã„ã€‚<br>â€»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ã®ãŸã‚ç”»åƒä»¥å¤–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã™ã€‚</div>
                </div>
                <div class="preview-container" id="previewContainer">
                    <img id="palmPreview" class="preview-img" src="" alt="æ‰‹ç›¸ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼" crossorigin="anonymous">
                    <div class="preview-actions"><button type="button" class="btn-change-img" onclick="resetPalmImage()">æ’®ã‚Šç›´ã™ / ç”»åƒã‚’å¤‰æ›´ã™ã‚‹</button></div>
                </div>
            </div>
            <button class="main-btn palm-btn" onclick="startPalmOracle()">æ‰‹ç›¸ã®é€è¦–ã‚’é–‹å§‹ã™ã‚‹</button>
        </div>

        <div id="form-tarot" class="content-area">
            <div class="site-title" style="color:var(--accent-tarot);">DEEP TAROT SPREAD</div><h1 class="site-title-ja">æ·±å±¤ã‚¿ãƒ­ãƒƒãƒˆãƒ»ã‚¹ãƒªãƒ¼ã‚«ãƒ¼ãƒ‰</h1>
            <p class="site-subtitle">ã€œ å¤§ã‚¢ãƒ«ã‚«ãƒŠãŒè§£ãæ˜ã‹ã™ã€éå»ã®å› æœã¨æœªæ¥ã®å•“ç¤º ã€œ</p>
            <div class="form-group"><label>ãŠåå‰ (NAME)</label><input type="text" id="name4" placeholder="ä¾‹ï¼šç´«éŸ³ ç²" autocomplete="off" maxlength="30"></div>
            <div class="form-group"><label>ç”Ÿå¹´æœˆæ—¥ (BIRTH DATE)</label><input type="date" id="dob4" class="date-input"></div>
            
            <div class="form-group">
                <label>ç¾åœ¨ã‚ãªãŸãŒæŠ±ãˆã¦ã„ã‚‹å…·ä½“çš„ãªæ‚©ã¿ï¼ˆè‡ªç”±å…¥åŠ›ï¼‰</label>
                <textarea id="worry4" placeholder="ä¾‹ï¼šå½¼ã‹ã‚‰é€£çµ¡ãŒæ¥ãªãã¦ä¸å®‰ã€‚ä»Šã®ä»•äº‹ã‚’è¾ã‚ã‚‹ã¹ãã‹è¿·ã£ã¦ã„ã‚‹ã€‚äººé–“é–¢ä¿‚ãŒè¾›ã„..." style="border-color: rgba(155,89,182,0.6);" maxlength="400"></textarea>
                <div style="font-size:11px; color:var(--text-sub); margin-top:5px;">â€»å…¥åŠ›ã•ã‚ŒãŸæ‚©ã¿ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®æ³¢å‹•ã‚’è§£æã—ã€å¼•ã‹ã‚ŒãŸã‚«ãƒ¼ãƒ‰ã¨ç´ä»˜ã‘ã¦ã€ã‚ãªãŸã ã‘ã®å€‹åˆ¥ç¥è¨—ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</div>
            </div>
            <button class="main-btn tarot-btn" onclick="startTarotOracle()">ç²¾ç¥ã‚’é›†ä¸­ã—ã€ã‚«ãƒ¼ãƒ‰ã‚’å±•é–‹ã™ã‚‹</button>
        </div>

        <div id="loading">
            <div class="mystic-wheel" id="mWheel"></div>
            <div class="scan-container" id="scanBox">
                <img src="" class="scan-target-img" id="scanTargetImg">
                <div class="scan-grid"></div>
                <div class="scanner-line" id="scannerLine"></div>
            </div>
            <div class="loading-text" id="loadingText">ACCESSING AKASHIC RECORDS...</div>
        </div>

        <div id="res-daily" class="content-area">
            <div class="result-header"><div class="result-name" id="resName1"></div><div class="result-meta" id="resDate1"></div></div>
            <div class="story-card">
                <img src="https://images.unsplash.com/photo-1633423712532-601e3b6d415e?q=80&w=800&auto=format&fit=crop" class="story-img" alt="Tarot">
                <div class="story-content"><div class="story-title" id="tarotCardName_daily"></div><div class="story-text" id="msgDailyTotal"></div></div>
            </div>
            <div class="story-card" style="border-color:var(--gold);">
                <div class="story-content">
                    <div class="story-title" style="color:var(--gold); border-left: 3px solid var(--gold); padding-left: 12px; margin-bottom: 15px; font-weight: 700;">é‹å‘½ã‚’å¥½è»¢ã•ã›ã‚‹ç‰¹åˆ¥ã‚¢ãƒ‰ãƒã‚¤ã‚¹</div>
                    <div class="story-text" id="msgDailyPremium" style="color:var(--gold-light);"></div>
                </div>
            </div>
            <div class="share-section">
                <div class="share-title">ï¼¼ é‘‘å®šçµæœã‚’ã‚·ã‚§ã‚¢ã™ã‚‹ ï¼</div>
                <div class="share-buttons">
                    <button class="sns-btn btn-x" onclick="shareResult('x', 'daily')"><svg viewBox="0 0 512 512"><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg> X ã§ã‚·ã‚§ã‚¢</button>
                    <button class="sns-btn btn-ig" onclick="shareResult('ig', 'daily')"><svg viewBox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg> Instagramã§ã‚·ã‚§ã‚¢</button>
                </div>
            </div>
            <button class="btn-retry" onclick="resetApp()">åˆ¥ã®å ã„ã‚’è©¦ã™</button>
        </div>

        <div id="res-destiny" class="content-area love-theme">
            <div class="result-header"><div class="result-name" id="resName2"></div><div class="result-meta">TWIN RAY READING RESULT</div></div>
            <div class="story-card"><img src="https://images.unsplash.com/photo-1518599904199-0ca897819ddb?q=80&w=800&auto=format&fit=crop" class="story-img" alt="Soul"><div class="story-content"><div class="story-title">ç¬¬1ç« ï¼šç¾åœ¨ã®çŠ¶æ³ã¨é­‚ã®çœŸå®Ÿ</div><div class="story-text" id="resD_status"></div></div></div>
            <div class="story-card"><img src="https://images.unsplash.com/photo-1462206092226-f46025ffe607?q=80&w=800&auto=format&fit=crop" class="story-img" alt="Past Life"><div class="story-content"><div class="story-title">ç¬¬2ç« ï¼šå‰ä¸–ã‹ã‚‰ã®å› ç¸</div><div class="story-text" id="resD_past"></div></div></div>
            
            <div class="premium-wrapper locked" id="premium-destiny">
                <div class="premium-blur-target">
                    <div class="story-card" style="margin-bottom:0; border:none; box-shadow:none;"><img src="https://images.unsplash.com/photo-1532012197267-da84d127e765?q=80&w=800&auto=format&fit=crop" class="story-img" alt="Appearance"><div class="story-content"><div class="story-title">ç¬¬3ç« ï¼šç›¸æ‰‹ã®ã€Œå®¹å§¿ã€ã¨ã€Œè£ã®é¡”ã€</div><div class="story-text" id="resD_char"></div></div></div>
                    <div class="story-card" style="margin-bottom:0; border:none; border-top:1px solid rgba(255,255,255,0.05); box-shadow:none;"><img src="https://images.unsplash.com/photo-1501139083538-0139583c060f?q=80&w=800&auto=format&fit=crop" class="story-img" alt="Timing"><div class="story-content"><div class="story-title">ç¬¬4ç« ï¼šäº¤å·®ã™ã‚‹ã€Œæ™‚æœŸã€ã¨å‰å…†</div><div class="story-text" id="resD_timing"></div></div></div>
                    <div class="story-card" style="margin-bottom:0; border:none; border-top:1px solid rgba(255,255,255,0.05); box-shadow:none;"><div class="story-content"><div class="story-title">ç¬¬5ç« ï¼šçµã°ã‚Œã‚‹ãŸã‚ã®æœ€çµ‚è©¦ç·´</div><div class="story-text" id="resD_premium"></div></div></div>
                </div>
                <div class="paywall-overlay">
                    <div style="font-size: 30px; margin-bottom: 10px;">ğŸ”’</div>
                    <div style="color:var(--accent-love); font-size: 18px; font-weight: bold; margin-bottom: 10px;">ã“ã“ã‹ã‚‰å…ˆã¯ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é‘‘å®š</div>
                    <div style="font-size: 13px; color: var(--text-sub); margin-bottom: 20px; line-height: 1.6;">é‹å‘½ã®ç›¸æ‰‹ã®ã€Œå®¹å§¿ã€ã‚„ã€Œè£ã®é¡”ã€ã€äºŒäººãŒäº¤å·®ã™ã‚‹ã€Œå…·ä½“çš„ãªæ™‚æœŸã¨å‰å…†ã€ã®å®Œå…¨ãªå•“ç¤ºã‚’è§£æ”¾ã—ã¾ã™ã€‚</div>
                    <a href="javascript:void(0);" onclick="unlockPremium('destiny')" class="paywall-btn">1,500å††ã§å®Œå…¨ç‰ˆã‚’è¦–ã‚‹</a>
                </div>
            </div>

            <div class="share-section">
                <div class="share-title">ï¼¼ é‘‘å®šçµæœã‚’ã‚·ã‚§ã‚¢ã™ã‚‹ ï¼</div>
                <div class="share-buttons">
                    <button class="sns-btn btn-x" onclick="shareResult('x', 'destiny')"><svg viewBox="0 0 512 512"><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg> X ã§ã‚·ã‚§ã‚¢</button>
                    <button class="sns-btn btn-ig" onclick="shareResult('ig', 'destiny')"><svg viewBox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg> Instagramã§ã‚·ã‚§ã‚¢</button>
                </div>
            </div>
            <button class="btn-retry" style="border-color:var(--accent-love); color:var(--accent-love);" onclick="resetApp()">CLOSE AKASHIC RECORDS</button>
        </div>

        <div id="res-palm" class="content-area palm-theme">
            <div class="result-header"><div class="result-name" id="resName3"></div><div class="result-meta">MYSTIC PALM READING RESULT</div></div>
            <div class="story-card" style="text-align:center; padding-top:25px;">
                <img id="resPalmImg" src="" alt="ã‚ãªãŸã®æ‰‹ç›¸" style="width:140px; height:140px; object-fit:cover; border-radius:50%; border:3px solid var(--accent-palm); box-shadow:0 0 20px rgba(32,178,170,0.4);">
                <div style="font-size:12px; color:var(--text-sub); margin-top:12px; letter-spacing: 1px;">æŒã®ç›¸ç´‹ãƒ»èª­ã¿å–ã‚Šå®Œäº†</div>
            </div>
            <div class="story-card"><div class="story-content"><div class="story-title">ã€æ·±å±¤é‘‘å®šã€‘æ‰‹ç›¸ã®å…¨ä½“åƒ</div><div class="story-text" id="resP_overall"></div></div></div>
            <div class="story-card"><div class="story-content"><div class="story-title">åŸºæœ¬ï¼”ç·šã®éœŠçš„åˆ†æ</div><div class="story-text"><p id="resP_life"></p><p id="resP_head"></p><p id="resP_heart"></p><p id="resP_fate"></p></div></div></div>
            
            <div class="premium-wrapper locked" id="premium-palm">
                <div class="premium-blur-target">
                    <div class="story-card" style="margin-bottom:0; border:none; box-shadow:none;"><div class="story-content"><div class="story-title">ä»Šå¾Œã®æœªæ¥ï¼ˆé‹å‘½ã®è»¢æ©Ÿã¨è»Œè·¡ï¼‰</div><div class="story-text" id="resP_future"></div></div></div>
                    <div class="story-card" style="margin-bottom:0; border:none; border-top:1px solid rgba(255,255,255,0.05); box-shadow:none;"><div class="story-content"><div class="story-title">ä»Šå¾Œã®æ‹æ„›ãƒ»ä»•äº‹é‹</div><div class="story-text"><p id="resP_love"></p><p id="resP_work"></p></div></div></div>
                </div>
                <div class="paywall-overlay">
                    <div style="font-size: 30px; margin-bottom: 10px;">ğŸ”’</div>
                    <div style="color:var(--accent-palm); font-size: 18px; font-weight: bold; margin-bottom: 10px;">ã“ã“ã‹ã‚‰å…ˆã¯ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é€è¦–</div>
                    <div style="font-size: 13px; color: var(--text-sub); margin-bottom: 20px; line-height: 1.6;">ã‚ãªãŸã®äººç”ŸãŒæ¿€å¤‰ã™ã‚‹ã€Œä»Šå¾Œã®æœªæ¥ã€ã¨<br>ã€Œæ‹æ„›é‹ãƒ»ä»•äº‹é‹ã€ã®è©³ç´°ãªè»Œè·¡ã‚’å®Œå…¨å…¬é–‹ã—ã¾ã™ã€‚</div>
                    <a href="javascript:void(0);" onclick="unlockPremium('palm')" class="paywall-btn">800å††ã§æœªæ¥ã‚’ã‚¢ãƒ³ãƒ­ãƒƒã‚¯</a>
                </div>
            </div>

            <div class="share-section">
                <div class="share-title">ï¼¼ é‘‘å®šçµæœã‚’ã‚·ã‚§ã‚¢ã™ã‚‹ ï¼</div>
                <div class="share-buttons">
                    <button class="sns-btn btn-x" onclick="shareResult('x', 'palm')"><svg viewBox="0 0 512 512"><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg> X ã§ã‚·ã‚§ã‚¢</button>
                    <button class="sns-btn btn-ig" onclick="shareResult('ig', 'palm')"><svg viewBox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg> Instagramã§ã‚·ã‚§ã‚¢</button>
                </div>
            </div>
            <button class="btn-retry" style="border-color:var(--accent-palm); color:var(--accent-palm);" onclick="resetApp()">FINISH ANALYSIS</button>
        </div>

        <div id="res-tarot" class="content-area tarot-theme">
            <div class="result-header"><div class="result-name" id="resName4"></div><div class="result-meta">THREE CARD SPREAD RESULT</div></div>
            
            <div class="tarot-spread">
                <div class="t-card-wrap"><div class="t-label">PAST (éå»)</div><div class="t-card-inner" id="tCard1"><div class="t-face t-back">âœ¦</div><div class="t-face t-front"><div class="t-front-num" id="tcNum1"></div><div class="t-front-name" id="tcName1"></div><div class="t-front-pos" id="tcPos1"></div></div></div></div>
                <div class="t-card-wrap"><div class="t-label">PRESENT (ç¾åœ¨)</div><div class="t-card-inner" id="tCard2"><div class="t-face t-back">âœ¦</div><div class="t-face t-front"><div class="t-front-num" id="tcNum2"></div><div class="t-front-name" id="tcName2"></div><div class="t-front-pos" id="tcPos2"></div></div></div></div>
                <div class="t-card-wrap"><div class="t-label">FUTURE (æœªæ¥)</div><div class="t-card-inner" id="tCard3"><div class="t-face t-back">âœ¦</div><div class="t-face t-front"><div class="t-front-num" id="tcNum3"></div><div class="t-front-name" id="tcName3"></div><div class="t-front-pos" id="tcPos3"></div></div></div></div>
            </div>

            <div class="story-card"><div class="story-content"><div class="story-title">ç¬¬1ã®å•“ç¤ºï¼šæ‚©ã¿ã®ã€Œæ ¹æœ¬åŸå› ï¼ˆéå»ï¼‰ã€</div><div class="story-text" id="resT_past"></div></div></div>
            <div class="story-card"><div class="story-content"><div class="story-title">ç¬¬2ã®å•“ç¤ºï¼šå–ã‚Šå·»ãã€Œç¾çŠ¶ï¼ˆç¾åœ¨ï¼‰ã€</div><div class="story-text" id="resT_present"></div></div></div>
            
            <div class="premium-wrapper locked" id="premium-tarot">
                <div class="premium-blur-target">
                    <div class="story-card" style="margin-bottom:0; border:none; box-shadow:none;"><div class="story-content"><div class="story-title">ç¬¬3ã®å•“ç¤ºï¼šã‚„ãŒã¦è¨ªã‚Œã‚‹ã€Œçµæœ«ï¼ˆæœªæ¥ï¼‰ã€</div><div class="story-text" id="resT_future"></div></div></div>
                    <div class="story-card" style="margin-bottom:0; border:none; border-top:1px solid rgba(255,255,255,0.05); box-shadow:none;">
                        <div class="story-content">
                            <div class="story-title" style="color:var(--gold); border-color:var(--gold);">ç¥ä»£ã‚¢ãƒªã‚¹ã‹ã‚‰ã®å€‹åˆ¥ç¥è¨—ã‚¢ãƒ³ã‚µãƒ¼</div>
                            <div class="story-text" id="tarotFinalMsg" style="color:var(--gold-light);"></div>
                        </div>
                    </div>
                </div>
                <div class="paywall-overlay">
                    <div style="font-size: 30px; margin-bottom: 10px;">ğŸ”’</div>
                    <div style="color:var(--accent-tarot); font-size: 18px; font-weight: bold; margin-bottom: 10px;">ã“ã“ã‹ã‚‰å…ˆã¯ç‰¹åˆ¥å€‹åˆ¥é‘‘å®š</div>
                    <div style="font-size: 13px; color: var(--text-sub); margin-bottom: 20px; line-height: 1.6;">å¼•ã‹ã‚ŒãŸã‚«ãƒ¼ãƒ‰ã‹ã‚‰å°ã‹ã‚Œã‚‹ã€Œæœ€çµ‚çš„ãªæœªæ¥ã€ã€ãã—ã¦ã‚ãªãŸã®æ‚©ã¿ã«å¯¾ã™ã‚‹ã€Œå®Œå…¨ãªã‚‹å€‹åˆ¥ã‚¢ãƒ³ã‚µãƒ¼ã€ã‚’è§£æ”¾ã—ã¾ã™ã€‚</div>
                    <a href="javascript:void(0);" onclick="unlockPremium('tarot')" class="paywall-btn">1,000å††ã§ç¥è¨—ã‚’å—ã‘å–ã‚‹</a>
                </div>
            </div>

            <div class="share-section">
                <div class="share-title">ï¼¼ é‘‘å®šçµæœã‚’ã‚·ã‚§ã‚¢ã™ã‚‹ ï¼</div>
                <div class="share-buttons">
                    <button class="sns-btn btn-x" onclick="shareResult('x', 'tarot')"><svg viewBox="0 0 512 512"><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg> X ã§ã‚·ã‚§ã‚¢</button>
                    <button class="sns-btn btn-ig" onclick="shareResult('ig', 'tarot')"><svg viewBox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg> Instagramã§ã‚·ã‚§ã‚¢</button>
                </div>
            </div>

            <button class="btn-retry" style="border-color:var(--accent-tarot); color:var(--accent-tarot);" onclick="resetApp()">CLOSE TAROT SPREAD</button>
        </div>

        <div class="bottom-actions">
            <button class="btn-home" onclick="backToHome()">â—€ ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ï¼ˆã‚µãƒ­ãƒ³å…¥å£ï¼‰ã«æˆ»ã‚‹</button>
            <div class="action-row">
                <button class="btn-setting" onclick="openPassModal()">ğŸ”‘ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´</button>
                <button class="btn-logout" onclick="doLogout()">ğŸšª ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¦é€€å®¤</button>
            </div>
        </div>

    </div>
</div>

<script>
    // ğŸ›¡ï¸ XSS(ã‚¯ãƒ­ã‚¹ã‚µã‚¤ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒ†ã‚£ãƒ³ã‚°)å¯¾ç­–é–¢æ•°
    function escapeHTML(str) {
        if(typeof str !== 'string') return '';
        return str.replace(/[&<>'"]/g, function(match) {
            const escapeMap = { '&': '&amp;', '<': '&lt;', '>': '&gt;', "'": '&#39;', '"': '&quot;' };
            return escapeMap[match];
        });
    }

    // ==========================================
    // ğŸ”® ã‚·ã‚¹ãƒ†ãƒ åˆæœŸè¨­å®š
    // ==========================================
    const SITE_URL = "https://hoshiiuranai.com/"; 
    const shareTextCache = {};
    let pendingUserData = null; 
    let generatedVerifyCode = "";
    
    // ã€é‡è¦ã€‘æœ¬ç‰©ã®ãƒ¡ãƒ¼ãƒ«ã‚’é£›ã°ã™ãŸã‚ã®ã€ŒEmailJSã€ã®è¨­å®šé …ç›®
    const EMAILJS_SERVICE_ID = "service_m6oqaw9"; 
    const EMAILJS_TEMPLATE_ID = "template_n59vwqm";
    const EMAILJS_PUBLIC_KEY = "H3a49IOLHGqZpyl7q";

    // ğŸ›¡ï¸ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯ç”¨è¨­å®š (è¦ä»¶1å¯¾å¿œ)
    const MAX_LOGIN_ATTEMPTS = 10;
    const LOCK_TIME_MS = 15 * 60 * 1000; // 15åˆ†ãƒ­ãƒƒã‚¯
    
    window.onload = () => {
        initAdmin();
        updateTopBtn();
        if (typeof emailjs !== 'undefined') { emailjs.init(EMAILJS_PUBLIC_KEY); }
        
        const today = new Date();
        const yyyy = today.getFullYear();
        const mm = String(today.getMonth() + 1).padStart(2, '0');
        const dd = String(today.getDate()).padStart(2, '0');
        const todayStr = `${yyyy}-${mm}-${dd}`;
        document.querySelectorAll('.date-input').forEach(input => { 
            input.setAttribute('max', todayStr); 
            input.setAttribute('min', '1930-01-01');
        });

        // ç®¡ç†è€…ç”¨2FA (PIN) å…¥åŠ›æ¬„ã®è¡¨ç¤ºåˆ¶å¾¡
        document.getElementById("loginEmail").addEventListener("input", function(e) {
            if(e.target.value.trim() === "admin@hoshiiuranai.com") {
                document.getElementById("adminPinGroup").style.display = "block";
            } else {
                document.getElementById("adminPinGroup").style.display = "none";
            }
        });

        // ğŸ›¡ï¸ URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã‚ˆã‚‹ç®¡ç†è€…ãƒ¢ãƒ¼ãƒ‰ã®ä»˜ä¸
        const urlParams = new URLSearchParams(window.location.search);
        if(urlParams.get('admin') === 'true') {
            localStorage.setItem("astral_currentUser", "admin@hoshiiuranai.com");
            localStorage.setItem("astral_isAdmin", "true");
        }
    };

    function isValidDob(dobStr) {
        if (!dobStr) { alert("ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"); return false; }
        const parts = dobStr.split('-');
        if(parts.length !== 3) return false;
        const d = new Date(parts[0], parts[1] - 1, parts[2]);
        const minD = new Date(1930, 0, 1);
        const today = new Date(); today.setHours(23, 59, 59, 999);
        if (d < minD) { alert("ç”Ÿå¹´æœˆæ—¥ã¯1930å¹´ä»¥é™ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"); return false; }
        if (d > today) { alert("æœªæ¥ã®æ—¥ä»˜ã¯å…¥åŠ›ã§ãã¾ã›ã‚“ã€‚"); return false; }
        return true;
    }

    // ==========================================
    // ğŸ” ä¼šå“¡ç™»éŒ²ãƒ»ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯å‡¦ç†
    // ==========================================
    function checkAccountLock(email) {
        let attempts = JSON.parse(localStorage.getItem("astral_login_attempts")) || {};
        if (attempts[email]) {
            if (attempts[email].lockedUntil && Date.now() < attempts[email].lockedUntil) {
                return true; 
            }
        }
        return false;
    }

    function recordLoginFailure(email) {
        let attempts = JSON.parse(localStorage.getItem("astral_login_attempts")) || {};
        if (!attempts[email]) attempts[email] = { count: 0, lockedUntil: null };
        
        attempts[email].count++;
        if (attempts[email].count >= MAX_LOGIN_ATTEMPTS) {
            attempts[email].lockedUntil = Date.now() + LOCK_TIME_MS;
        }
        localStorage.setItem("astral_login_attempts", JSON.stringify(attempts));
        return attempts[email].count;
    }

    function resetLoginAttempts(email) {
        let attempts = JSON.parse(localStorage.getItem("astral_login_attempts")) || {};
        if (attempts[email]) {
            delete attempts[email];
            localStorage.setItem("astral_login_attempts", JSON.stringify(attempts));
        }
    }

    function initAdmin() {
        let users = JSON.parse(localStorage.getItem("astral_users")) || {};
        if(!users["admin@hoshiiuranai.com"]) {
            users["admin@hoshiiuranai.com"] = { 
                name: "ãƒã‚¹ã‚¿ãƒ¼ç®¡ç†è€…", 
                password: "admin", 
                pin: "9999", 
                isAdmin: true 
            };
            localStorage.setItem("astral_users", JSON.stringify(users));
        }
    }

    function updateTopBtn() {
        const currentUser = localStorage.getItem("astral_currentUser");
        const btn = document.getElementById("topEnterBtn");
        if(currentUser) { btn.innerText = "é‘‘å®šã‚µãƒ­ãƒ³ã¸é€²ã‚€"; } 
        else { btn.innerText = "å ã£ã¦ã¿ã‚‹ï¼"; }
    }

    function enterSanctuary() { 
        if (localStorage.getItem("astral_currentUser")) {
            document.getElementById('page-home').classList.remove('active'); 
            document.getElementById('page-app').classList.add('active'); 
            switchTab('daily'); window.scrollTo(0, 0); 
        } else {
            document.getElementById("authModal").classList.add("active");
            switchAuthTab('login');
        }
    }
    
    function backToHome() { 
        resetApp(); 
        document.getElementById('page-app').classList.remove('active'); 
        document.getElementById('page-home').classList.add('active'); 
        updateTopBtn(); window.scrollTo(0, 0); 
    }

    function switchAuthTab(tab) {
        document.getElementById('loginAlert').style.display = 'none';
        document.querySelectorAll('.auth-tab').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.auth-form').forEach(el => el.classList.remove('active'));
        document.getElementById('authTabs').style.display = 'flex';

        if(tab === 'login') {
            document.querySelectorAll('.auth-tab')[0].classList.add('active');
            document.getElementById('auth-login').classList.add('active');
        } else {
            document.querySelectorAll('.auth-tab')[1].classList.add('active');
            document.getElementById('auth-register').classList.add('active');
        }
    }

    function closeAuthModal() { 
        document.getElementById('authModal').classList.remove('active'); 
        document.getElementById('loginAlert').style.display = 'none';
        pendingUserData = null; generatedVerifyCode = ""; document.getElementById("verifyCode").value = "";
        const btn = document.getElementById("btnSendVerify"); btn.innerText = "èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡"; btn.disabled = false;
        switchAuthTab('login');
    }

    function doLogin() {
        const alertBox = document.getElementById("loginAlert");
        alertBox.style.display = "none";
        
        const email = escapeHTML(document.getElementById("loginEmail").value.trim());
        const pass = document.getElementById("loginPass").value.trim(); 
        const pin = escapeHTML(document.getElementById("loginAdminPin").value.trim());
        
        if(!email || !pass) return alert("ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");

        if (checkAccountLock(email)) {
            const attempts = JSON.parse(localStorage.getItem("astral_login_attempts")) || {};
            const lockoutEnd = attempts[email].lockedUntil;
            const remain = Math.ceil((lockoutEnd - Date.now()) / 60000);
            alertBox.innerText = `ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯ä¸­ã€‘\né€£ç¶šã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ãŸãŸã‚ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚ã¨ç´„ ${remain} åˆ†ãŠå¾…ã¡ãã ã•ã„ã€‚`;
            alertBox.style.display = "block";
            return;
        }
        
        let users = JSON.parse(localStorage.getItem("astral_users")) || {};
        const user = users[email];
        
        if(user && user.password === pass) {
            if (user.isAdmin && user.pin !== pin) {
                const fails = recordLoginFailure(email);
                alertBox.innerText = `äºŒæ®µéšèªè¨¼ã‚³ãƒ¼ãƒ‰(PIN)ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚\n(å¤±æ•— ${fails}/${MAX_LOGIN_ATTEMPTS} å›)`;
                alertBox.style.display = "block";
                return;
            }

            resetLoginAttempts(email);
            localStorage.setItem("astral_currentUser", email);
            if(user.isAdmin) {
                localStorage.setItem("astral_isAdmin", "true");
                alert("ãƒã‚¹ã‚¿ãƒ¼ç®¡ç†è€…ã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸã€‚\nã™ã¹ã¦ã®ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é‘‘å®šãŒã€ç„¡æ–™ã€‘ã§è§£æ”¾ã•ã‚Œã¾ã™ã€‚");
            } else {
                localStorage.removeItem("astral_isAdmin");
            }
            closeAuthModal(); enterSanctuary();
        } else {
            const fails = recordLoginFailure(email);
            if (fails >= MAX_LOGIN_ATTEMPTS) {
                alertBox.innerText = `ã€è­¦å‘Šã€‘${MAX_LOGIN_ATTEMPTS}å›ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ãŸãŸã‚ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¿è­·ã®è¦³ç‚¹ã‹ã‚‰ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’15åˆ†é–“ãƒ­ãƒƒã‚¯ã—ã¾ã—ãŸã€‚`;
            } else {
                alertBox.innerText = `ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã¾ã™ã€‚\n(å¤±æ•— ${fails}/${MAX_LOGIN_ATTEMPTS} å›)`;
            }
            alertBox.style.display = "block";
        }
    }

    // ğŸ“© æ–°è¦ç™»éŒ²ï¼†ãƒ¡ãƒ¼ãƒ«èªè¨¼ãƒ•ãƒ­ãƒ¼
    function sendVerification(event) {
        const name = escapeHTML(document.getElementById("regName").value.trim()); 
        const email = escapeHTML(document.getElementById("regEmail").value.trim());
        const pass = document.getElementById("regPass").value.trim();
        
        if(!name || !email || !pass) return alert("ã™ã¹ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
        if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) return alert("æ­£ã—ã„ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
        if(pass.length < 4) return alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯4æ–‡å­—ä»¥ä¸Šã§è¨­å®šã—ã¦ãã ã•ã„ã€‚");
        
        let users = JSON.parse(localStorage.getItem("astral_users")) || {};
        if(users[email]) return alert("ã“ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯æ—¢ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™ã€‚\nã€Œãƒ­ã‚°ã‚¤ãƒ³ã€ã‚¿ãƒ–ã‹ã‚‰ãŠå…¥ã‚Šãã ã•ã„ã€‚");
        
        generatedVerifyCode = Math.floor(100000 + Math.random() * 900000).toString();
        pendingUserData = { name: name, email: email, pass: pass };
        
        const btn = document.getElementById("btnSendVerify");
        const originalText = btn.innerText;
        btn.innerText = "ãƒ¡ãƒ¼ãƒ«é€ä¿¡ä¸­..."; btn.disabled = true;

        const templateParams = { to_email: email, to_name: name, verification_code: generatedVerifyCode };
        
        emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, templateParams)
        .then(function(response) {
            document.getElementById("verifyGuide").innerHTML = `ã”å…¥åŠ›ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã«6æ¡ã®èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’ãŠé€ã‚Šã—ã¾ã—ãŸã€‚<br>å—ä¿¡ãƒœãƒƒã‚¯ã‚¹ï¼ˆã¾ãŸã¯è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ãƒ•ã‚©ãƒ«ãƒ€ï¼‰ã‚’ã”ç¢ºèªãã ã•ã„ã€‚`;
            document.querySelectorAll('.auth-form').forEach(el => el.classList.remove('active'));
            document.getElementById('authTabs').style.display = 'none';
            document.getElementById('auth-verify').classList.add('active');
            btn.innerText = originalText; btn.disabled = false;
        }, function(error) {
            console.error('FAILED...', error);
            let errorMsg = error.text || error.message || "é€šä¿¡ã‚¨ãƒ©ãƒ¼";
            alert("ã€ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚¨ãƒ©ãƒ¼ã€‘\n" + errorMsg + "\n\nâ€»ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ­£ã—ã„ã‹ã”ç¢ºèªãã ã•ã„ã€‚");
            btn.innerText = originalText; btn.disabled = false;
        });
    }

    function verifyEmail() {
        const code = escapeHTML(document.getElementById("verifyCode").value.trim());
        if(code !== generatedVerifyCode) {
            return alert("èªè¨¼ã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        
        let users = JSON.parse(localStorage.getItem("astral_users")) || {};
        users[pendingUserData.email] = { name: pendingUserData.name, password: pendingUserData.pass, isAdmin: false };
        localStorage.setItem("astral_users", JSON.stringify(users));
        localStorage.setItem("astral_currentUser", pendingUserData.email);
        localStorage.removeItem("astral_isAdmin");
        
        pendingUserData = null; generatedVerifyCode = ""; document.getElementById("verifyCode").value = "";
        
        alert("ãƒ¡ãƒ¼ãƒ«èªè¨¼ãŒå®Œäº†ã—ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼\nã‚µãƒ­ãƒ³ã¸ã”æ¡ˆå†…ã—ã¾ã™ã€‚");
        closeAuthModal(); 
        enterSanctuary();
    }

    function doLogout() {
        if(confirm("ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¦é€€å®¤ã—ã¾ã™ã‹ï¼Ÿ")) {
            localStorage.removeItem("astral_currentUser");
            localStorage.removeItem("astral_isAdmin");
            alert("ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚");
            backToHome();
        }
    }

    // ğŸ”‘ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´
    function openPassModal() {
        document.getElementById('oldPass').value = ""; document.getElementById('newPass').value = "";
        document.getElementById('passModal').classList.add('active');
    }
    function closePassModal() { document.getElementById('passModal').classList.remove('active'); }

    function changePassword() {
        const oldPass = document.getElementById('oldPass').value; 
        const newPass = document.getElementById('newPass').value;
        if(!oldPass || !newPass) return alert("ã™ã¹ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
        if(newPass.length < 4) return alert("æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯4æ–‡å­—ä»¥ä¸Šã§è¨­å®šã—ã¦ãã ã•ã„ã€‚");
        
        const currentUserEmail = localStorage.getItem("astral_currentUser");
        if(!currentUserEmail) return alert("ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã¾ã›ã‚“ã€‚");
        
        let users = JSON.parse(localStorage.getItem("astral_users")) || {};
        const user = users[currentUserEmail];
        if(!user || user.password !== oldPass) { return alert("ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã¾ã™ã€‚"); }
        
        user.password = newPass;
        localStorage.setItem("astral_users", JSON.stringify(users));
        alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å®‰å…¨ã«å¤‰æ›´ã—ã¾ã—ãŸã€‚"); closePassModal();
    }

    // ==========================================
    // ğŸ’° èª²é‡‘ï¼ˆãƒšã‚¤ã‚¦ã‚©ãƒ¼ãƒ«ï¼‰ç®¡ç†è€…è‡ªå‹•è§£é™¤ 
    // ==========================================
    function applyPaywallState() {
        const isAdmin = localStorage.getItem("astral_isAdmin") === "true";
        document.querySelectorAll('.premium-wrapper').forEach(el => {
            if(isAdmin) { el.classList.remove('locked'); el.classList.add('unlocked'); } 
            else { el.classList.add('locked'); el.classList.remove('unlocked'); }
        });
    }

    function unlockPremium(type) {
        const msg = "â€»ã“ã‚Œã¯èª²é‡‘ã‚·ã‚¹ãƒ†ãƒ ã®å‹•ä½œãƒ‡ãƒ¢ã§ã™ã€‚\n\nå®Ÿéš›ã«ã¯ã“ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã®æ±ºæ¸ˆç”»é¢ï¼ˆStripeãªã©ï¼‰ã¸é£›ã³ã¾ã™ã€‚\n\nã€ŒOKã€ã‚’æŠ¼ã™ã¨æ±ºæ¸ˆãŒå®Œäº†ã—ãŸã¨ä»®å®šã—ã¦ã€éš ã•ã‚ŒãŸé‘‘å®šçµæœã‚’è¡¨ç¤ºã—ã¾ã™ã€‚";
        if (confirm(msg)) {
            const el = document.getElementById('premium-' + type);
            if (el) { el.classList.remove('locked'); el.classList.add('unlocked'); }
        }
    }

    // ==========================================
    // ğŸ”® SNSã‚·ã‚§ã‚¢æ©Ÿèƒ½
    // ==========================================
    function shareResult(platform, type) {
        let text = shareTextCache[type] || "ç·åˆå ã„ã‚µãƒ­ãƒ³ã€æ˜Ÿå±‘ã®ç¥è¨—ã€ã§æœ¬æ ¼é‘‘å®šã‚’ä½“é¨“ã—ã¾ã—ãŸğŸ”®";
        const hash = "\n#æ˜Ÿå±‘ã®ç¥è¨— #å ã„ #ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«";
        const fullText = text + hash;

        if (platform === 'x') {
            const shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(fullText)}&url=${encodeURIComponent(SITE_URL)}`;
            window.open(shareUrl, '_blank');
        } else if (platform === 'ig') {
            const igText = fullText + "\n\nâ–¼ç„¡æ–™é‘‘å®šã¯ã“ã¡ã‚‰ã‹ã‚‰ï¼\n" + SITE_URL;
            const copyToClipboard = () => {
                if (navigator.clipboard && window.isSecureContext) { return navigator.clipboard.writeText(igText); } 
                else {
                    let textArea = document.createElement("textarea"); textArea.value = igText; textArea.style.position = "fixed"; textArea.style.left = "-999999px"; textArea.style.top = "-999999px";
                    document.body.appendChild(textArea); textArea.focus(); textArea.select();
                    return new Promise((res, rej) => { document.execCommand('copy') ? res() : rej(); textArea.remove(); });
                }
            };
            copyToClipboard().then(() => {
                alert("âœ¨é‘‘å®šçµæœã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼âœ¨\n\nã€ŒOKã€ã‚’æŠ¼ã™ã¨InstagramãŒé–‹ãã¾ã™ã€‚\nã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚ºã‚„æŠ•ç¨¿ç”»é¢ã§ã€ãƒšãƒ¼ã‚¹ãƒˆï¼ˆè²¼ã‚Šä»˜ã‘ï¼‰ã€ã—ã¦ã‚·ã‚§ã‚¢ã—ã¦ãã ã•ã„ğŸ“¸");
                window.open('https://www.instagram.com/ruminauranai/', '_blank');
            }).catch(() => {
                alert("ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãŠæ‰‹æ•°ã§ã™ãŒç”»é¢ã‚’ã‚¹ã‚¯ã‚·ãƒ§ã—ã¦ã‚·ã‚§ã‚¢ã—ã¦ãã ã•ã„ï¼");
            });
        }
    }

    // ==========================================
    // ğŸ”® å ã„ç”»é¢ã®åˆ¶å¾¡ 
    // ==========================================
    const advisors = {
        daily: { photo: "image.png", role: "Astrology & Tarot", name: "æ˜Ÿå° ãƒ«ãƒŸãƒŠ", bio: "ä»£ã€…ç¶šãæ˜Ÿèª­ã¿ã®å®¶ç³»ã«ç”Ÿã¾ã‚Œã€è¥¿æ´‹å æ˜Ÿè¡“ã¨ã‚¿ãƒ­ãƒƒãƒˆã‚’çµ±åˆã€‚ã‚ãªãŸã®é­‚ã«åˆ»ã¾ã‚ŒãŸéå»ãƒ»ç¾åœ¨ãƒ»æœªæ¥ã®è¨˜éŒ²ã‚’èª­ã¿è§£ãã€é‹å‘½ã‚’å¥½è»¢ã•ã›ã‚‹å…·ä½“çš„ãªé“æ¨™ã‚’æç¤ºã—ã¾ã™ã€‚" },
        destiny: { photo: "image2.png", role: "Twin Ray Reader", name: "å¤©éœ§ çµç¥ˆ", bio: "å¹¼å°‘æœŸã‚ˆã‚Šä»–è€…ã®ã€Œã”ç¸ã®ç³¸ã€ãŒè¦–ãˆã‚‹ç‰¹ç•°ä½“è³ªã‚’æŒã¤ã€‚ç¾åœ¨ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ãŒã„ã‚‹æ–¹ã§ã‚‚ã€é­‚ãƒ¬ãƒ™ãƒ«ã§ã®ã€æœ¬å½“ã®é‹å‘½ã®ç›¸æ‰‹ï¼ˆãƒ„ã‚¤ãƒ³ãƒ¬ã‚¤ï¼‰ã€ã‚’æ­£ç¢ºã«ç‰¹å®šã—ã€å½ã‚Šã®ãªã„çœŸå®Ÿã‚’ãŠä¼ãˆã—ã¾ã™ã€‚" },
        palm: { photo: "image3.png", role: "Mystic Palm Reader", name: "ç¥å®®å¯º å¸", bio: "å¤ä»£ã®æ‰‹ç›¸å­¦ã¨ç‹¬è‡ªã®é€è¦–æŠ€è¡“ã‚’çµ±åˆã€‚æŒã«åˆ»ã¾ã‚ŒãŸã‚·ãƒ¯ã®æ·±ã•ã€ç”Ÿå‘½ã®æ³¢å‹•ã‚’èª­ã¿å–ã‚Šã€ã‚ãªãŸã®ç„¡æ„è­˜ã®æ‰èƒ½ã¨æœªæ¥ã®è»Œè·¡ã‚’ä¸¸è£¸ã«ã—ã¾ã™ã€‚" },
        tarot: { photo: "image4.png", role: "Spiritual Tarot", name: "ç¥ä»£ ã‚¢ãƒªã‚¹", bio: "å¤§ã‚¢ãƒ«ã‚«ãƒŠå…¨22æšã®æ³¢å‹•ã‚’æ“ã‚Šã€æ½œåœ¨æ„è­˜ã®æœ€æ·±éƒ¨ã‚’è¦–é€ã‹ã™éœŠæ„Ÿã‚¿ãƒ­ãƒƒãƒˆãƒªãƒ¼ãƒ€ãƒ¼ã€‚ã‚ãªãŸãŒå…¥åŠ›ã—ãŸæ‚©ã¿ã®æ–‡å­—æ³¢å‹•ã‚’èª­ã¿å–ã‚Šã€è§£æ±ºã¸ã¨å°ãã‚ãªãŸã ã‘ã®å€‹åˆ¥ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ç´¡ãå‡ºã—ã¾ã™ã€‚" }
    };

    function switchTab(type) {
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active')); document.querySelectorAll('.content-area').forEach(div => div.classList.remove('active'));
        document.querySelector(`.tab-btn.t-${type}`).classList.add('active'); document.getElementById('form-' + type).classList.add('active');

        const photoEl = document.getElementById('advPhoto'); photoEl.style.opacity = 0;
        setTimeout(() => {
            photoEl.onerror = () => { photoEl.src = 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=200&fit=crop'; };
            photoEl.src = advisors[type].photo; document.getElementById('advRole').innerText = advisors[type].role; document.getElementById('advName').innerText = advisors[type].name; document.getElementById('advBio').innerText = advisors[type].bio;
            const pWrap = document.getElementById('advPhotoWrap'); let color = 'var(--gold)'; let shadow = 'rgba(212,175,55,0.3)';
            if(type === 'destiny') { color = 'var(--accent-love)'; shadow = 'rgba(201,91,122,0.3)'; } else if(type === 'palm') { color = 'var(--accent-palm)'; shadow = 'rgba(32,178,170,0.3)'; } else if(type === 'tarot') { color = 'var(--accent-tarot)'; shadow = 'rgba(155,89,182,0.3)'; }
            document.getElementById('advRole').style.color = color; pWrap.style.background = `linear-gradient(135deg, ${color}, #222)`; pWrap.style.boxShadow = `0 0 30px ${shadow}`; photoEl.style.opacity = 1;
        }, 300);
    }

    function showLoading(text, color, isPalm, callback) {
        document.getElementById("tab-menu").style.display = "none"; document.getElementById("profile-area").style.display = "none"; document.querySelectorAll(".content-area").forEach(el => el.classList.remove("active"));
        document.getElementById("loadingText").innerText = text; document.getElementById("loadingText").style.color = color;
        
        if (isPalm) { document.getElementById("mWheel").style.display = "none"; document.getElementById("scanBox").style.display = "block"; document.getElementById("scannerLine").style.display = "block"; } 
        else { document.getElementById("scanBox").style.display = "none"; const mWheel = document.getElementById("mWheel"); mWheel.style.display = "block"; mWheel.style.borderColor = `rgba(255,255,255,0.2)`; mWheel.style.borderTopColor = color; mWheel.style.borderBottomColor = color; }
        
        document.getElementById("loading").style.display = "block"; window.scrollTo({ top: 0, behavior: "smooth" });
        setTimeout(() => { document.getElementById("loading").style.display = "none"; if(isPalm) document.getElementById("scannerLine").style.display = "none"; callback(); }, isPalm ? 4000 : 3000); 
    }

    function resetApp() {
        document.querySelectorAll(".content-area").forEach(el => el.classList.remove("active")); document.getElementById("tab-menu").style.display = "flex"; document.getElementById("profile-area").style.display = "flex";
        document.querySelectorAll('.premium-wrapper').forEach(el => { el.classList.add('locked'); el.classList.remove('unlocked'); });

        const activeTab = document.querySelector('.tab-btn.active').classList.contains('t-daily') ? 'form-daily' : document.querySelector('.tab-btn.active').classList.contains('t-destiny') ? 'form-destiny' : document.querySelector('.tab-btn.active').classList.contains('t-palm') ? 'form-palm' : 'form-tarot';
        document.getElementById(activeTab).classList.add("active"); document.querySelectorAll('.t-card-inner').forEach(card => card.classList.remove('flipped')); window.scrollTo({ top: 0, behavior: "smooth" });
    }

    function getSeededRandom(seedStr) { let seed = 0; for (let i = 0; i < seedStr.length; i++) seed = seedStr.charCodeAt(i) + ((seed << 5) - seed); seed = Math.abs(seed); return function() { let x = Math.sin(seed++) * 10000; return x - Math.floor(x); } }

    // ==========================================
    // ğŸ”® 1. æ—¥ã€…ã®é‹å‹¢ (å®Œå…¨ç„¡æ–™åŒ–)
    // ==========================================
    const dailyTarots = [{ name: "æ„šè€…", m: "æœªçŸ¥ã¸ã®æŒ‘æˆ¦ã€‚" },{ name: "é­”è¡“å¸«", m: "å‰µé€ åŠ›ã€æ–°ã—ã„å§‹ã¾ã‚Šã€‚" },{ name: "å¥³å¸", m: "è±Šã‹ã•ã¨æ„›æƒ…ã®æˆå°±ã€‚" },{ name: "é‹å‘½ã®è¼ª", m: "å¥½è»¢ã€ãƒãƒ£ãƒ³ã‚¹åˆ°æ¥ã€‚" },{ name: "æ˜Ÿ", m: "å¸Œæœ›ã¨æ·±ã„ç™’ã‚„ã—ã€‚" }];
    function startDailyOracle() {
        try {
            const rawName = document.getElementById("name1").value.trim(); 
            const name = escapeHTML(rawName);
            const dob = escapeHTML(document.getElementById("dob1").value);
            if (!isValidDob(dob)) return; 
            if (!name) return alert("ãŠåå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");

            showLoading("READING ASTROLOGICAL ALIGNMENTS...", "var(--gold)", false, () => {
                const random = getSeededRandom(name + dob + new Date().getDate()); 
                const tarot = dailyTarots[Math.floor(random() * dailyTarots.length)]; const position = random() > 0.7 ? "ï¼ˆé€†ä½ç½®ï¼‰" : "ï¼ˆæ­£ä½ç½®ï¼‰";
                document.getElementById("resName1").innerText = name + " æ§˜"; document.getElementById("resDate1").innerText = `TODAY'S ORACLE`;
                document.getElementById("tarotCardName_daily").innerText = "å°ãã®ã‚«ãƒ¼ãƒ‰ï¼š " + tarot.name + " " + position;
                
                document.getElementById("msgDailyTotal").innerHTML = `<p>æœ¬æ—¥ã®å¤©ç©ºå›³ã‚’èª­ã¿è§£ãã¨ã€æœˆãŒå¹¸é‹ã®æ˜Ÿã¨é‡ãªã‚Šå¼·åŠ›ãªã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æ”¾ã£ã¦ã„ã¾ã™ã€‚</p><p>å¼•ã‹ã‚ŒãŸã‚«ãƒ¼ãƒ‰ã¯ã€${tarot.name}ã€${position}ã€‚</p>`;
                
                const colors = ["ãƒ«ãƒ“ãƒ¼ãƒ¬ãƒƒãƒ‰", "ã‚µãƒ•ã‚¡ã‚¤ã‚¢ãƒ–ãƒ«ãƒ¼", "ã‚¨ãƒ¡ãƒ©ãƒ«ãƒ‰ã‚°ãƒªãƒ¼ãƒ³", "ãƒ‘ãƒ¼ãƒ«ãƒ›ãƒ¯ã‚¤ãƒˆ", "ã‚¢ãƒ¡ã‚¸ã‚¹ãƒˆãƒ‘ãƒ¼ãƒ—ãƒ«"];
                document.getElementById("msgDailyPremium").innerHTML = `<p>${tarot.m} ä»Šæ—¥ã¯ç›´æ„Ÿã®èµ´ãã¾ã¾ã«è¡Œå‹•ã—ã€å®‡å®™ã‹ã‚‰ã®ã‚µã‚¤ãƒ³ã‚’å—ã‘å–ã£ã¦ãã ã•ã„ã€‚ç„¡ç†ã«é€†ã‚‰ã‚ãšã€è‡ªç„¶ã®æµã‚Œã«èº«ã‚’ä»»ã›ã‚‹ã“ã¨ã§ã€å¤œã«ã¯å¤§ããªå……å®Ÿæ„Ÿã‚’å¾—ã‚‰ã‚Œã‚‹ã§ã—ã‚‡ã†ã€‚</p><p>ã•ã‚‰ã«ã€èº«ã«ã¤ã‘ã‚‹ã¨è‰¯ã„ãƒ©ãƒƒã‚­ãƒ¼ã‚«ãƒ©ãƒ¼ã¯ã€Œ<span class='highlight'>${colors[Math.floor(random()*colors.length)]}</span>ã€ã€‚é‡è¦ãªæ±ºæ–­ã¯åˆå¾Œ3æ™‚ä»¥é™ã«è¡Œã†ã¨ã‚¹ãƒ ãƒ¼ã‚ºã«é€²ã¿ã¾ã™ã€‚</p>`;

                shareTextCache['daily'] = `ğŸŒŸã€æ˜Ÿå±‘ã®ç¥è¨—ã€‘${name}æ§˜ã®ä»Šæ—¥ã®é‹å‹¢ã‚’å ã„ã¾ã—ãŸï¼\nå°ãã®ã‚«ãƒ¼ãƒ‰:ã€${tarot.name}ã€${position}âœ¨\n`;
                document.getElementById("res-daily").classList.add("active");
            });
        } catch(e) { console.error(e); alert("ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã‚’æ›´æ–°ã—ã¦ãã ã•ã„ã€‚"); }
    }

    // ==========================================
    // ğŸ”® 2. é‹å‘½ã®ç›¸æ‰‹ 
    // ==========================================
    function startDestinyOracle() {
        try {
            const rawName = document.getElementById("name2").value.trim(); 
            const name = escapeHTML(rawName);
            const dob = escapeHTML(document.getElementById("dob2").value); 
            const status = escapeHTML(document.getElementById("status2").value);
            if (!isValidDob(dob)) return;
            if (!name) return alert("ãŠåå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");

            showLoading("ACCESSING SOUL CONTRACTS...", "var(--accent-love)", false, () => {
                const random = getSeededRandom(name + dob + status + "v_premium_final"); 
                document.getElementById("resName2").innerText = name + " æ§˜";
                let msgStatus = "";
                if (status === "single") { msgStatus = `<p>ç¾åœ¨ãƒ•ãƒªãƒ¼ã®ã‚ãªãŸã€‚ç„¡æ„è­˜ã«å¿ƒã®å£ã‚’ä½œã£ã¦ã„ã‚‹æ³¢å‹•ãŒè¦–ãˆã¾ã™ã€‚ã—ã‹ã—ã€ã‚ãªãŸã®<span class='love-highlight'>é­‚ã®åŠèº«ï¼ˆãƒ„ã‚¤ãƒ³ãƒ¬ã‚¤ï¼‰</span>ã¯ã€ã™ã§ã«ã‚ãªãŸã®ã™ãè¿‘ãã¾ã§æ¥è¿‘ã—ã¦ãã¦ã„ã¾ã™ã€‚</p>`; } 
                else if (status === "partner") {
                    const partnerVariations = [
                        `<p>éœŠè¦–ã®æ³¢é•·ã‚’ä»Šã®ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã«åˆã‚ã›ã¦ã¿ã¾ã—ãŸã€‚ç¾ä¸–ã«ãŠã„ã¦å¤§åˆ‡ãªã€Œå­¦ã³ã€ã‚’ä¸ãˆåˆã†é‡è¦ãªã‚½ã‚¦ãƒ«ãƒ¡ã‚¤ãƒˆã§ã™ã€‚</p><p>ã—ã‹ã—ã€é­‚ã®æœ€æ·±éƒ¨ã¾ã§æ·±ãæ½œã£ã¦ã¿ã‚‹ã¨ã€<span class='love-highlight'>ã‚ãªãŸã®ã€æœ¬å½“ã®é‹å‘½ã®ç›¸æ‰‹ã€ã¯ã€åˆ¥ã«ã‚‚ã†ä¸€äººå­˜åœ¨ã—ã¦ã„ã‚‹</span>ã¨ã„ã†å¼·çƒˆãªæ³¢å‹•ã‚’æ„Ÿã˜ã¾ã™ã€‚ä»Šã®é–¢ä¿‚ã«å­¤ç‹¬ã‚’æ„Ÿã˜ã¦ã„ã‚‹ãªã‚‰ã€ãã‚Œã¯é­‚ãŒæœ¬æ¥ã®åŠèº«ã‚’æ±‚ã‚ã¦ã„ã‚‹ã‚µã‚¤ãƒ³ã§ã™ã€‚</p>`,
                        `<p>ç¾åœ¨ã®ãŠç›¸æ‰‹ã¨ã¯ã€å‰ä¸–ã‹ã‚‰æŒã¡è¶Šã—ãŸã€æ·±ã„ã‚«ãƒ«ãƒã€ã®è§£æ¶ˆã®ãŸã‚ã«çµã°ã‚Œã¦ã„ã¾ã™ã€‚æ„›ã¨åŸ·ç€ãŒå…¥ã‚Šäº¤ã˜ã‚‹é–¢ä¿‚ã«ãªã‚Šã‚„ã™ã„æ™‚æœŸã§ã™ã€‚</p><p>ã“ã®ã‚«ãƒ«ãƒã®æ¸…ç®—ãŒé€²ã‚€ã«ã¤ã‚Œã€ã‚ã‚‹çœŸå®ŸãŒæµ®ãå½«ã‚Šã«ãªã‚Šã¾ã™ã€‚ãã‚Œã¯ã€<span class='love-highlight'>ã‚ãªãŸã®ã€æœ¬å½“ã®é‹å‘½ã®ç›¸æ‰‹ã€ã¯ã€åˆ¥ã«ã‚‚ã†ä¸€äººå­˜åœ¨ã—ã¦ã„ã‚‹</span>ã¨ã„ã†äº‹å®Ÿã§ã™ã€‚ä»Šã®é–¢ä¿‚ã¯ã€ãã®ç©¶æ¥µã®ç›¸æ‰‹ã¨çµã°ã‚Œã‚‹ãŸã‚ã®é­‚ã®æº–å‚™æœŸé–“ã«ä»–ãªã‚Šã¾ã›ã‚“ã€‚</p>`,
                        `<p>ç¾åœ¨ã®é–¢ä¿‚æ€§ã«ãŠã„ã¦ã€ã‚ãªãŸã®é­‚ã¯ä»Šã€éå¸¸ã«å¤§ããªè»¢æ›æœŸã‚’è¿ãˆã¦ã„ã¾ã™ã€‚ä»Šã®ãŠç›¸æ‰‹ã«æ„Ÿè¬ã®å¿µã‚’æŠ±ãã¤ã¤ã‚‚ã€ã©ã“ã‹ã€Œè‡ªåˆ†ãŒæœ¬å½“ã«é‚„ã‚‹ã¹ãå ´æ‰€ã€ã‚’æ¢ã—ã¦ã„ã‚‹ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚</p><p>ã‚¢ã‚«ã‚·ãƒƒã‚¯ãƒ¬ã‚³ãƒ¼ãƒ‰ã®è¨˜è¿°ã¯æ®‹é…·ãªã¾ã§ã«æ˜ç¢ºã§ã™ã€‚<span class='love-highlight'>ã‚ãªãŸã®ã€æœ¬å½“ã®é‹å‘½ã®ç›¸æ‰‹ã€ã¯ã€åˆ¥ã«ã‚‚ã†ä¸€äººå­˜åœ¨ã—ã¦ã„ã‚‹</span>ã®ã§ã™ã€‚é ã‹ã‚‰ãšè¨ªã‚Œã‚‹ãã®å‡ºé€¢ã„ãŒã€ã‚ãªãŸã®äººç”Ÿã‚’å®Œå…¨ã«å®Œæˆã•ã›ã‚‹ã§ã—ã‚‡ã†ã€‚</p>`
                    ];
                    msgStatus = partnerVariations[Math.floor(random() * partnerVariations.length)];
                } else { msgStatus = `<p>ç¾åœ¨ã€è¤‡é›‘ãªé–¢ä¿‚æ€§ã®ä¸­ã§é­‚ãŒã™ã‚Šæ¸›ã£ã¦ã„ã¾ã™ã€‚<span class='alert-text'>ã‚ãªãŸãŒä»ŠåŸ·ç€ã—ã¦ã„ã‚‹ãã®æ–¹ã¯ã€æœ¬å½“ã®é‹å‘½ã®ç›¸æ‰‹ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</span>åŸ·ç€ã‚’æ‰‹æ”¾ã—ãŸç¬é–“ã«æœ¬ç‰©ã®æ„›ãŒå…¥ã‚Šè¾¼ã‚€ã‚¹ãƒšãƒ¼ã‚¹ãŒç”Ÿã¾ã‚Œã¾ã™ã€‚</p>`; }
                document.getElementById("resD_status").innerHTML = msgStatus;
                document.getElementById("resD_past").innerHTML = `<p>äºŒäººã¯éå»ä¸–ã§æ·±ãæ„›ã—åˆã„ãªãŒã‚‰ã‚‚å¼•ãè£‚ã‹ã‚ŒãŸå› ç¸ãŒã‚ã‚Šã¾ã™ã€‚ãã®å¼·çƒˆãªå¿µãŒç£çŸ³ã¨ãªã‚Šã€ç¾ä»£ã§å†ã³å¼•ãåˆã£ã¦ã„ã¾ã™ã€‚</p>`;
                document.getElementById("resD_char").innerHTML = `<p>è¡¨å‘ãã¯çœŸé¢ç›®ã§ã‚¯ãƒ¼ãƒ«ã§ã™ãŒã€æ·±ã„ä»²ã«ãªã‚‹ã¨è±¹å¤‰ã—ã¾ã™ã€‚<span class='love-highlight'>ã‚ãªãŸã«å¯¾ã—ã¦ã ã‘ã¯ã€Œç”˜ãˆã‚“åŠã€ãªä¸€é¢ã‚’è¦‹ã›ã‚‹ã§ã—ã‚‡ã†ã€‚</span></p>`;
                document.getElementById("resD_timing").innerHTML = `<p>äºŒäººã®é­‚ã®è»Œé“ãŒäº¤å·®ã™ã‚‹æ™‚æœŸã¯ã€ã‚ãªãŸãŒã€ä»Šã®åŸ·ç€ã‚’æ‰‹æ”¾ã—ãŸç›´å¾Œã€ã§ã™ã€‚æ•°å­—ã®ã‚¾ãƒ­ç›®ã‚’ã‚ˆãè¦‹ã‚‹ã‚ˆã†ã«ãªã£ãŸã‚‰åˆå›³ã§ã™ã€‚</p>`;
                
                document.getElementById("resD_premium").innerHTML = `<p>äºŒäººãŒå®Œå…¨ã«çµã°ã‚Œã‚‹ãŸã‚ã«å¿…è¦ãªã€Œçµ¶å¯¾æ¡ä»¶ã€ã¯ã€ã‚ãªãŸãŒä»Šç„¡æ„è­˜ã«æŠ±ãˆã¦ã„ã‚‹ã€Œéå»ã®äººé–“é–¢ä¿‚ã¸ã®åŸ·ç€ã€ã‚’æ‰‹æ”¾ã™ã“ã¨ã§ã™ã€‚ãã‚Œã‚’ä¹—ã‚Šè¶ŠãˆãŸæ™‚ã€ç›¸æ‰‹ã®é­‚ã¯ã‚ãªãŸã®å…ƒã¸å¼·çƒˆã«å¼•ãå¯„ã›ã‚‰ã‚Œã¾ã™ã€‚</p><p>é­‚ã®çµ±åˆãŒèµ·ã“ã‚‹é‹å‘½ã®æ—¥ã¯ã€ã‚ãªãŸãŒå¿ƒã‹ã‚‰ãƒªãƒ©ãƒƒã‚¯ã‚¹ã—ã¦éã”ã—ã¦ã„ã‚‹ä¼‘æ—¥ã®åˆå¾Œã«çªç„¶è¨ªã‚Œã¾ã™ã€‚ãã®æ™‚ã‚’ä¿¡ã˜ã¦ã€ä»Šã¯è‡ªåˆ†ç£¨ãã«å°‚å¿µã—ã¦ãã ã•ã„ã€‚</p>`;

                shareTextCache['destiny'] = `ğŸ’•ã€æ˜Ÿå±‘ã®ç¥è¨—ã€‘${name}æ§˜ã®ã€æœ¬å½“ã®é‹å‘½ã®ç›¸æ‰‹(ãƒ„ã‚¤ãƒ³ãƒ¬ã‚¤)ã€ã‚’æ·±å±¤éœŠè¦–ã§ç‰¹å®šã—ã¾ã—ãŸï¼\né­‚ãŒäº¤å·®ã™ã‚‹æ™‚æœŸãŒè¿‘ã¥ã„ã¦ã„ã¾ã™â€¦ï¼\n`;
                
                applyPaywallState(); 
                document.getElementById("res-destiny").classList.add("active");
            });
        } catch(e) { console.error(e); alert("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å…¥åŠ›å†…å®¹ã‚’ã”ç¢ºèªãã ã•ã„ã€‚"); }
    }

    // ==========================================
    // âœ‹ 3. ç”»åƒæ‰‹ç›¸é‘‘å®š 
    // ==========================================
    let currentImageElement = null; 
    function previewPalmImage(event) {
        const file = event.target.files[0];
        if (file) {
            const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];
            if (!validTypes.includes(file.type)) {
                alert("ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¨ãƒ©ãƒ¼ï¼šç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆJPG, PNG, GIF, WEBPãªã©ï¼‰ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚");
                resetPalmImage();
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                const src = e.target.result; document.getElementById("palmPreview").src = src; 
                currentImageElement = new Image(); currentImageElement.src = src;
                document.getElementById("uploadBox").style.display = "none"; document.getElementById("previewContainer").style.display = "block";
            }
            reader.readAsDataURL(file);
        }
    }
    function resetPalmImage() { document.getElementById("palmImage").value = ""; currentImageElement = null; document.getElementById("previewContainer").style.display = "none"; document.getElementById("uploadBox").style.display = "block"; }

    function analyzePalmImage(img) {
        return new Promise((resolve) => {
            const canvas = document.createElement('canvas'); const ctx = canvas.getContext('2d'); canvas.width = 150; canvas.height = 150; ctx.drawImage(img, 0, 0, 150, 150);
            let imgData; try { imgData = ctx.getImageData(0, 0, 150, 150); } catch(e) { resolve({ isHand: true, hash: 9999, edgeRatio: 0.1, brightness: 128 }); return; }
            
            const data = imgData.data; let skinToneCount = 0; let edgeCount = 0; let totalBrightness = 0; let hash = 0;
            for (let i = 0; i < data.length; i += 4) {
                let r = data[i], g = data[i+1], b = data[i+2]; hash = (hash * 31 + r + g + b) | 0; 
                if (r > 80 && g > 40 && b > 20 && r > g && r > b && Math.max(r,g,b) - Math.min(r,g,b) > 15) { skinToneCount++; }
                totalBrightness += (0.299 * r + 0.587 * g + 0.114 * b);
                if (i > 4 * 150) { let prevR = data[i-4], prevG = data[i-3], prevB = data[i-2]; let diff = Math.abs(r - prevR) + Math.abs(g - prevG) + Math.abs(b - prevB); if (diff > 45) edgeCount++; }
            }
            const pixelCount = data.length / 4;
            resolve({ isHand: (skinToneCount / pixelCount) > 0.15, hash: hash, edgeRatio: (edgeCount / pixelCount), brightness: (totalBrightness / pixelCount) });
        });
    }

    async function startPalmOracle() {
        try {
            const rawName = document.getElementById("name3").value.trim(); 
            const name = escapeHTML(rawName);
            const dob = escapeHTML(document.getElementById("dob3").value);
            if (!isValidDob(dob)) return;
            if (!name) return alert("ãŠåå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
            if (!currentImageElement) return alert("æ‰‹ã®ã²ã‚‰ã®å†™çœŸã‚’æ’®å½±ã€ã¾ãŸã¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚");
            
            const analysis = await analyzePalmImage(currentImageElement);
            if (!analysis.isHand) { alert("ã€ç”»åƒèª­ã¿å–ã‚Šã‚¨ãƒ©ãƒ¼ã€‘\næ‰‹ã®ã²ã‚‰ã®æ³¢å‹•ï¼ˆè‚Œè‰²æˆåˆ†ã‚„æŒç·šã®ç‰¹å¾´ï¼‰ãŒæ­£ã—ãæ¤œå‡ºã§ãã¾ã›ã‚“ã§ã—ãŸã€‚\næ‰‹ä»¥å¤–ã®å†™çœŸã‹ã€æš—ã™ãã‚‹å†™çœŸã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚æ˜ã‚‹ã„å ´æ‰€ã§æ‰‹ã®ã²ã‚‰å…¨ä½“ã‚’æ’®å½±ã—ã€å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚"); return; }

            showLoading("READING PALM LINES...", "var(--accent-palm)", true, () => {
                const random = getSeededRandom(name + analysis.hash.toString() + "palm_v4"); 
                document.getElementById("resName3").innerText = name + " æ§˜";
                document.getElementById("resPalmImg").src = currentImageElement.src;
                
                let skinType = analysis.brightness > 100 ? "ãµã£ãã‚‰ã¨ã—ãŸè±Šã‹ãªè‚‰ä»˜ãï¼ˆå„ä¸˜ã®ç™ºé”ï¼‰" : "ã™ã£ãã‚Šã¨ã—ãŸã‚¹ãƒãƒ¼ãƒˆãªè¼ªéƒ­";
                let edgeType = analysis.edgeRatio > 0.12 ? "ç´°ã‹ãªã‚·ãƒ¯ãŒç„¡æ•°ã«èµ°ã‚‹" : "ä¸»è¦ãªç·šãŒæ·±ãåŠ›å¼·ãåˆ»ã¾ã‚Œã¦ã„ã‚‹";
                let typeName = analysis.edgeRatio > 0.12 ? "æ°´ãƒ»é¢¨ã®è¦ç´ " : "ç«ãƒ»åœ°ã®è¦ç´ ";

                let overallText = `<p>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸç”»åƒã‹ã‚‰æŒã®è¼ªéƒ­ã¨ç·šã‚’ç²¾å¯†ã«èª­ã¿å–ã‚Šã¾ã—ãŸã€‚ã‚ãªãŸã®æ‰‹ã®ã²ã‚‰ã¯ã€Œ${skinType}ã€ã‚’æŒã¡ã€ã€Œ${edgeType}ã€ã¨ã„ã†ç‰¹å¾´ãŒç¢ºèªã§ãã¾ã™ã€‚</p>`;
                if (analysis.edgeRatio > 0.12) {
                    overallText += `<p>ç´°ã‹ãè¤‡é›‘ãªç·šãŒåˆ»ã¾ã‚ŒãŸæ‰‹ç›¸ã¯<span class='palm-highlight'>ã€Œ${typeName}ã€</span>ã‚’å¼·ãå¸¯ã³ã¦ãŠã‚Šã€éå¸¸ã«æ„Ÿå—æ€§ãŒé«˜ãã€ä»–äººã®ç—›ã¿ãŒã‚ã‹ã‚‹å„ªã—ã„æ€§æ ¼ã‚’è¡¨ã—ã¾ã™ã€‚ç›´æ„ŸåŠ›ã«å„ªã‚Œã€ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«ãªæ„Ÿæ€§ã‚‚æŒã¡åˆã‚ã›ã¦ã„ã‚‹ã§ã—ã‚‡ã†ã€‚</p>`;
                } else {
                    overallText += `<p>ä¸»è¦ãªç·šãŒãã£ãã‚Šã¨ç¾ã‚Œã‚‹æ‰‹ç›¸ã¯<span class='palm-highlight'>ã€Œ${typeName}ã€</span>ã‚’å¼·ãå¸¯ã³ã¦ãŠã‚Šã€è¿·ã„ãŒå°‘ãªãã€æ±ºæ–­åŠ›ã¨è¡Œå‹•åŠ›ã«å„ªã‚ŒãŸå¼·é­ãªãƒ¡ãƒ³ã‚¿ãƒ«ã®æŒã¡ä¸»ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã—ã¾ã™ã€‚è‡ªã‚‰ã®åŠ›ã§é‹å‘½ã‚’åˆ‡ã‚Šæ‹“ãåŠ›ã‚’æŒã£ã¦ã„ã¾ã™ã€‚</p>`;
                }
                if (analysis.brightness > 110) {
                    overallText += `<p>ã¾ãŸã€æŒå…¨ä½“ã®æ˜åº¦ã¨è¡€è‰²ã®åˆ†æã‹ã‚‰ã€<span class='palm-highlight'>æ˜ã‚‹ãæ¸©ã‹ã„æ³¢å‹•ï¼ˆç”Ÿå‘½ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰</span>ãŒå¼·ãæ„Ÿã˜ã‚‰ã‚Œã¾ã™ã€‚ç¾åœ¨ã€ã‚ãªãŸã®é‹æ°—ãŒä¸Šæ˜‡æ°—æµã«ä¹—ã£ã¦ãŠã‚Šã€æ–°ã—ã„ã“ã¨ã‚’å§‹ã‚ã‚‹ã®ã«æœ€é©ãªæ™‚æœŸã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚</p>`;
                } else {
                    overallText += `<p>ã¾ãŸã€æŒã®é™°å½±ã®æ·±ã•ã‹ã‚‰ã€ç¾åœ¨ã¯<span class='palm-highlight'>å†…çœã—ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’è“„ãˆã‚‹æ™‚æœŸï¼ˆé™ã®æ³¢å‹•ï¼‰</span>ã§ã‚ã‚‹ã“ã¨ãŒèª­ã¿å–ã‚Œã¾ã™ã€‚ç„¦ã‚‰ãšè‡ªåˆ†è‡ªèº«ã¨å‘ãåˆã†ã“ã¨ã§ã€å¾Œã«å¤§ããªé£›èºã‚’é‚ã’ã‚‹æº–å‚™æœŸé–“ã§ã™ã€‚</p>`;
                }
                document.getElementById("resP_overall").innerHTML = overallText;
                
                const p_lifes = ["æ‰‹é¦–ã®æ–¹å‘ã¸é•·ãæ·±ãåˆ»ã¾ã‚Œã¦ãŠã‚Šã€éå¸¸ã«å¼·ã„ç”Ÿå‘½åŠ›ã¨ãƒã‚¤ã‚¿ãƒªãƒ†ã‚£ã‚’ç§˜ã‚ã¦ã„ã¾ã™ã€‚", "è¦ªæŒ‡ã®ä»˜ã‘æ ¹ï¼ˆé‡‘æ˜Ÿä¸˜ï¼‰ã‚’å¤§ããå›²ã‚€ã‚ˆã†ã«ä¼¸ã³ã¦ã„ã¾ã™ã€‚ã¨ã¦ã‚‚æ„›æƒ…æ·±ãã€äººã‚’å¼•ãä»˜ã‘ã‚‹ã‚«ãƒªã‚¹ãƒæ€§ã‚’æ”¾ã£ã¦ã„ã¾ã™ã€‚"];
                const p_heads = ["çœŸæ¨ªã«è¿‘ã„è§’åº¦ã§ä¸€ç›´ç·šã«ä¼¸ã³ã¦ã„ã¾ã™ã€‚è«–ç†çš„ã‹ã¤ç¾å®Ÿçš„ã§ã€æ„Ÿæƒ…ã«æµã•ã‚Œãšã«çš„ç¢ºãªåˆ¤æ–­ã‚’ä¸‹ã›ã‚‹æ€è€ƒå›è·¯ã®æŒã¡ä¸»ã§ã™ã€‚", "æ‰‹é¦–ã®ä¸‹æ–¹ï¼ˆæœˆä¸˜ï¼‰ã«å‘ã‹ã£ã¦ç¾ã—ã„ã‚«ãƒ¼ãƒ–ã‚’æã„ã¦ã„ã¾ã™ã€‚è±Šã‹ãªæƒ³åƒåŠ›ã¨ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãªæ‰èƒ½ã«æµã¾ã‚Œã¦ã„ã¾ã™ã€‚"];
                document.getElementById("resP_life").innerHTML = "<strong style='color:var(--gold-light);'>ã€ç”Ÿå‘½ç·šã€‘</strong> " + p_lifes[Math.floor(random() * p_lifes.length)];
                document.getElementById("resP_head").innerHTML = "<strong style='color:var(--gold-light);'>ã€çŸ¥èƒ½ç·šã€‘</strong> " + p_heads[Math.floor(random() * p_heads.length)];
                document.getElementById("resP_heart").innerHTML = "<strong style='color:var(--gold-light);'>ã€æ„Ÿæƒ…ç·šã€‘</strong> äººå·®ã—æŒ‡ã¨ä¸­æŒ‡ã®é–“ã«å‘ã‹ã£ã¦æ€¥ãªã‚«ãƒ¼ãƒ–ã‚’æã„ã¦ä¼¸ã³ã¦ã„ã¾ã™ã€‚éå¸¸ã«æƒ…ç†±çš„ã§ã€æ„›ã™ã‚‹äººã«ã¯ã¨ã“ã¨ã‚“å°½ãã™æ·±ã„æ„›æƒ…ã®æŒã¡ä¸»ã§ã™ã€‚";
                document.getElementById("resP_fate").innerHTML = "<strong style='color:var(--gold-light);'>ã€é‹å‘½ç·šã€‘</strong> æ‰‹ã®ã²ã‚‰ã®ä¸­å¤®ã‚’ä¸­æŒ‡ã«å‘ã‹ã£ã¦åŠ›å¼·ãçªãæŠœã‘ã¦ã„ã¾ã™ã€‚è‡ªã‚‰ã®ä¿¡å¿µã¨å®ŸåŠ›ã ã‘ã§ã€ç¤¾ä¼šçš„ãªå¤§æˆåŠŸã‚’åã‚ã‚‹åŠ›ã‚’æŒã£ã¦ã„ã¾ã™ã€‚";
                
                document.getElementById("resP_future").innerHTML = `<p>æŒã®åˆ»ã¿ã‹ã‚‰æœªæ¥ã‚’é€è¦–ã™ã‚‹ã¨ã€<span class='palm-highlight'>æ•°å¹´ä»¥å†…ã«ã‚ãªãŸã®äººç”Ÿã®ã‚¹ãƒ†ãƒ¼ã‚¸ãŒä¸€æ®µéšä¸ŠãŒã‚‹ã€ŒåŠ‡çš„ãªé£›èºã®æ™‚æœŸã€</span>ãŒè¨ªã‚Œã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚</p><p>ã“ã‚Œã¾ã§ã‚ãªãŸãŒæ°´é¢ä¸‹ã§ç©ã¿é‡ã­ã¦ããŸåŠªåŠ›ã‚„æˆ‘æ…¢ãŒã€ä¸€æ°—ã«å ±ã‚ã‚Œã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒè¿‘ã¥ã„ã¦ã„ã¾ã™ã€‚å…¨ãæ–°ã—ã„ç’°å¢ƒã‚„æœªçŸ¥ã®å½¹å‰²ã«é£›ã³è¾¼ã‚€ã“ã¨ã§ã€æƒ³åƒä»¥ä¸Šã®ã‚¹ã‚±ãƒ¼ãƒ«ã§ç‰©äº‹ãŒå±•é–‹ã—ã€äººç”Ÿã®é»„é‡‘æœŸã‚’è¿ãˆã‚‹ã§ã—ã‚‡ã†ã€‚</p>`;
                document.getElementById("resP_love").innerHTML = `<p>ä»Šå¾Œã®æ‹æ„›é‹ã¯ç©ã‚„ã‹ãªæ„›æƒ…ã«æº€ã¡ãŸæ™‚æœŸã«å…¥ã‚Šã¾ã™ã€‚ç„¡ç†ã‚’ã›ãšç´ ã®è‡ªåˆ†ã‚’å‡ºã›ã‚‹ç›¸æ‰‹ã¨ã®é–¢ä¿‚ãŒæ·±ã¾ã‚Šã¾ã™ã€‚ã‚ã‚Šã®ã¾ã¾ã®ã‚ãªãŸã®å¼±ã•ã™ã‚‰ã‚‚æ„›ã—ã¦ãã‚Œã‚‹ã€æµ·ã®ã‚ˆã†ã«å™¨ã®å¤§ããªæ„›ã«åŒ…ã¾ã‚Œã‚‹æœªæ¥ãŒè¦–ãˆã¦ã„ã¾ã™ã€‚</p>`;
                document.getElementById("resP_work").innerHTML = `<p>ä»•äº‹é‹ã¯ç‹¬è‡ªã®æ‰èƒ½ã‚„ã‚¢ã‚¤ãƒ‡ã‚¢ãŒçˆ†ç™ºçš„ã«è©•ä¾¡ã•ã‚Œã‚‹ã‚µã‚¤ãƒ³ãŒå‡ºã¦ã„ã¾ã™ã€‚ç›´æ„Ÿã«å¾“ã†ã“ã¨ã§é‡‘é‹ã‚‚é€£å‹•ã—ã¦è·³ã­ä¸ŠãŒã‚Šã¾ã™ã€‚çµ„ç¹”ã®ä¸­ã§è¨€ã‚ã‚ŒãŸã“ã¨ã‚’ã“ãªã™ã‚ˆã‚Šã‚‚ã€è‡ªåˆ†ã®è£é‡ã§å‹•ã‘ã‚‹ç’°å¢ƒã§å¤§æˆåŠŸã‚’åã‚ã‚‹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’ç§˜ã‚ã¦ã„ã¾ã™ã€‚</p>`;
                
                shareTextCache['palm'] = `âœ‹ã€æ˜Ÿå±‘ã®ç¥è¨—ã€‘ç”»åƒæ‰‹ç›¸é‘‘å®šã‚’å®Ÿè¡Œã—ã¾ã—ãŸï¼\n${name}æ§˜ã®æ‰‹ç›¸ã¯ã€Œ${typeName}ã€ã‚¿ã‚¤ãƒ—ã€‚\næ•°å¹´ä»¥å†…ã«åŠ‡çš„ãªé£›èºã®æ™‚æœŸãŒè¨ªã‚Œã‚‹ã‚µã‚¤ãƒ³ãŒå‡ºã¦ã„ã¾ã™ï¼âœ¨\n`;
                
                applyPaywallState();
                document.getElementById("res-palm").classList.add("active");
            });
        } catch(e) { console.error(e); alert("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å…¥åŠ›å†…å®¹ã‚’ã”ç¢ºèªãã ã•ã„ã€‚"); }
    }

    // ==========================================
    // ğŸ”® 4. æœ¬æ ¼ã‚¿ãƒ­ãƒƒãƒˆå ã„
    // ==========================================
    const majorArcana = [
        { ja: "æ„šè€…", en: "The Fool", num: "0", p: "ç„¡é™ã®å¯èƒ½æ€§ã€è‡ªç”±ã€ç›´æ„Ÿçš„ãªè¡Œå‹•", r: "ç„¡è¨ˆç”»ã€ç¾å®Ÿé€ƒé¿ã€ç„¡è²¬ä»»ãªè¡Œå‹•" }, { ja: "é­”è¡“å¸«", en: "The Magician", num: "I", p: "å‰µé€ åŠ›ã€æ–°ãŸãªå§‹ã¾ã‚Šã€æ‰èƒ½ã®é–‹èŠ±", r: "å„ªæŸ”ä¸æ–­ã€ã‚¹ãƒ©ãƒ³ãƒ—ã€æ‰èƒ½ã®ç„¡é§„é£" }, { ja: "å¥³æ•™çš‡", en: "The High Priestess", num: "II", p: "ç›´æ„Ÿã€ç²¾ç¥æ€§ã€é™ã‹ãªè¦³å¯Ÿ", r: "æ‰¹åˆ¤çš„ã€ç§˜å¯†ã®æš´éœ²ã€å†·é…·ã•" }, { ja: "å¥³å¸", en: "The Empress", num: "III", p: "è±Šã‹ã•ã€æ„›æƒ…ã®æˆå°±ã€å¤§ã„ãªã‚‹å®Ÿã‚Š", r: "å«‰å¦¬ã€éä¿è­·ã€ç›¸æ‰‹ã¸ã®ä¾å­˜" }, { ja: "çš‡å¸", en: "The Emperor", num: "IV", p: "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã€å®‰å®šã€è²¬ä»»æ„Ÿ", r: "æ”¯é…æ¬²ã€é ‘å›ºã€ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼" }, { ja: "æ•™çš‡", en: "The Hierophant", num: "V", p: "ä¼çµ±ã€ä¿¡é ¼ã€ç²¾ç¥çš„ãªå°ã", r: "æŸç¸›ã€å­¤ç«‹ã€å¤ã„ä¾¡å€¤è¦³ã¸ã®å›ºåŸ·" }, { ja: "æ‹äºº", en: "The Lovers", num: "VI", p: "æƒ…ç†±çš„ãªæ„›ã€æ­£ã—ã„é¸æŠã€å…±é³´", r: "èª˜æƒ‘ã€é–¢ä¿‚ã®å´©å£Šã€èª¤ã£ãŸé¸æŠ" }, { ja: "æˆ¦è»Š", en: "The Chariot", num: "VII", p: "å‰é€²ã€å‹åˆ©ã€å›°é›£ã®å…‹æœ", r: "æš´èµ°ã€æŒ«æŠ˜ã€ç„¦ç‡¥æ„Ÿ" }, { ja: "åŠ›", en: "Strength", num: "VIII", p: "å¿è€ã€ç²¾ç¥çš„ãªå¼·ã•ã€ç„¡å„Ÿã®æ„›", r: "ç„¡æ°—åŠ›ã€è‡ªä¿¡å–ªå¤±ã€æ¬²æœ›ã¸ã®æ•—åŒ—" }, { ja: "éš è€…", en: "The Hermit", num: "IX", p: "å†…çœã€çœŸç†ã®æ¢æ±‚ã€ä¸€äººã®æ™‚é–“", r: "å­¤ç‹¬ã€ç¾å®Ÿé€ƒé¿ã€é–‰é–çš„" }, { ja: "é‹å‘½ã®è¼ª", en: "Wheel of Fortune", num: "X", p: "å¥½è»¢ã€ãƒãƒ£ãƒ³ã‚¹åˆ°æ¥ã€ç´ æ™´ã‚‰ã—ã„å‡ºæ¥äº‹", r: "æ‚ªåŒ–ã€ã™ã‚Œé•ã„ã€ä¸é‹ã®é€£é–" }, { ja: "æ­£ç¾©", en: "Justice", num: "XI", p: "å…¬å¹³ã€æ±ºæ–­ã€ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸé–¢ä¿‚", r: "ä¸å…¬å¹³ã€åè¦‹ã€ãƒ¢ãƒ©ãƒ«ã®æ¬ å¦‚" }, { ja: "åŠã‚‹ã•ã‚ŒãŸç”·", en: "The Hanged Man", num: "XII", p: "è¦–ç‚¹ã®å¤‰åŒ–ã€è‡ªå·±çŠ ç‰²ã€æ‚Ÿã‚Š", r: "å¾’åŠ´ã€æˆ‘æ…¢ã®é™ç•Œã€èº«å‹•ããŒå–ã‚Œãªã„" }, { ja: "æ­»ç¥", en: "Death", num: "XIII", p: "å¼·åˆ¶çš„ãªçµ‚äº†ã€å†ç”Ÿã€æ–°ã—ã„ã‚¹ãƒ†ãƒ¼ã‚¸", r: "åŸ·ç€ã€åœæ»ã€å¤‰åŒ–ã¸ã®æã‚Œ" }, { ja: "ç¯€åˆ¶", en: "Temperance", num: "XIV", p: "èª¿å’Œã€ãƒãƒ©ãƒ³ã‚¹ã€è¦‹äº‹ãªèåˆ", r: "ä¸æ‘‚ç”Ÿã€æ„Ÿæƒ…ã®ä¹±ã‚Œã€æµªè²»" }, { ja: "æ‚ªé­”", en: "The Devil", num: "XV", p: "ç”˜ã„èª˜æƒ‘ã€åŸ·ç€ã€ç‰©è³ªçš„æ¬²æœ›", r: "æŸç¸›ã‹ã‚‰ã®è§£æ”¾ã€æ‚ªç¸ã‚’åˆ‡ã‚‹" }, { ja: "å¡”", en: "The Tower", num: "XVI", p: "äºˆæœŸã›ã¬ãƒˆãƒ©ãƒ–ãƒ«ã€è¡æ’ƒçš„ãªãƒªã‚»ãƒƒãƒˆ", r: "å´©å£Šã®å›é¿ã€é•·å¼•ãå•é¡Œ" }, { ja: "æ˜Ÿ", en: "The Star", num: "XVII", p: "å¸Œæœ›ã€ç†æƒ³ã®å®Ÿç¾ã€æ·±ã„ç™’ã‚„ã—", r: "çµ¶æœ›ã€è¦‹è¾¼ã¿é•ã„ã€ã‚¤ãƒ³ã‚¹ãƒ”ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®æ¯æ¸‡" }, { ja: "æœˆ", en: "The Moon", num: "XVIII", p: "ä¸å®‰ã€éš ã•ã‚ŒãŸçœŸå®Ÿã€æ½œåœ¨æ„è­˜ã®ææ€–", r: "éœ§ãŒæ™´ã‚Œã‚‹ã€ç›´æ„Ÿã®å†´ãˆã€ä¸å®‰ã‹ã‚‰ã®è§£æ”¾" }, { ja: "å¤ªé™½", en: "The Sun", num: "XIX", p: "å¤§æˆåŠŸã€å–œã³ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®çˆ†ç™º", r: "è¨ˆç”»ã®é…ã‚Œã€ä¸€æ™‚çš„ãªã‚¨ãƒãƒ«ã‚®ãƒ¼ä¸è¶³" }, { ja: "å¯©åˆ¤", en: "Judgement", num: "XX", p: "å¾©æ´»ã€å¥‡è·¡çš„ãªå†ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã€æ±ºæ–­", r: "éå»ã¸ã®å¾Œæ‚”ã€ãƒãƒ£ãƒ³ã‚¹ã‚’è¦‹é€ƒã™" }, { ja: "ä¸–ç•Œ", en: "The World", num: "XXI", p: "å®Œå…¨ãªã‚‹æˆå°±ã€ãƒãƒƒãƒ”ãƒ¼ã‚¨ãƒ³ãƒ‰", r: "æœªå®Œæˆã€ä¸­é€”åŠç«¯ã€ã‚¹ãƒ©ãƒ³ãƒ—" }
    ];

    function generateWorryAnswer(worry, futureCard, isFutureReversed) {
        const w = worry.trim(); let category = "general";
        if (/å½¼|å½¼å¥³|é€£çµ¡|å¾©ç¸|å¥½ã|æ„›|çµå©š|å¤«|å¦»|æ‹|å‡ºä¼šã„|åˆ¥ã‚Œ|ä¸å€«/.test(w)) category = "love";
        else if (/ä»•äº‹|è¾ã‚|è»¢è·|ä¸Šå¸|ä¼šç¤¾|äººé–“é–¢ä¿‚|å°±è·|ã‚­ãƒ£ãƒªã‚¢|åŒåƒš|ãƒ‘ãƒ¯ãƒãƒ©/.test(w)) category = "work";
        else if (/é‡‘|å€Ÿé‡‘|åå…¥|è²¯é‡‘|å®ãã˜|ç”Ÿæ´»/.test(w)) category = "money";
        const worrySnippet = w.length > 20 ? w.substring(0, 20) + "..." : w; const meaning = isFutureReversed ? futureCard.r : futureCard.p; const posStr = isFutureReversed ? "é€†ä½ç½®" : "æ­£ä½ç½®";
        
        let ans = `<p><span style="color:var(--text-sub); font-size:12px; border-bottom:1px dashed rgba(255,255,255,0.2); padding-bottom:5px; margin-bottom:10px; display:inline-block;">ã€ã‚ãªãŸã®æ‚©ã¿ï¼šã€Œ${worrySnippet}ã€ã¸ã®å›ç­”ã€‘</span></p>`;
        ans += `<p>ã‚ãªãŸãŒæ›¸ãè¾¼ã‚“ã§ãã‚ŒãŸæ‚©ã¿ã€ã—ã£ã‹ã‚Šã¨å¤§ã‚¢ãƒ«ã‚«ãƒŠã®æ³¢å‹•ã«å±Šã„ã¦ã„ã¾ã™ã€‚æœªæ¥ã«å‡ºãŸã€${futureCard.ja}ã€ã®${posStr}ã¯ã€ã“ã®æ‚©ã¿ã«å¯¾ã™ã‚‹æœ€çµ‚å›ç­”ã¨ã—ã¦<span class="tarot-highlight">ã€${meaning}ã€‘</span>ã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã£ã¦ãã¾ã—ãŸã€‚</p>`;

        if (category === "love") {
            if (!isFutureReversed) ans += `<p>ä»Šã‚ãªãŸãŒæŠ±ãˆã¦ã„ã‚‹æ‹æ„›ã¸ã®ä¸å®‰ã¯ã€é ã‹ã‚‰ãšæ„›ã¨èª¿å’Œã®æ–¹å‘ã¸å‹•ãå‡ºã—ã¾ã™ã€‚ç›¸æ‰‹ã®æ°—æŒã¡ã‚’ç„¡ç†ã«æ¢ã£ãŸã‚Šã›ãšã€ã‚ãªãŸãŒè‡ªä¿¡ã‚’æŒã¡åŸ·ç€ã‚’æ‰‹æ”¾ã—ãŸæ™‚ã€ç›¸æ‰‹ã‹ã‚‰è‡ªç„¶ã¨å¼•ãå¯„ã›ã‚‰ã‚Œã¦ãã‚‹ã§ã—ã‚‡ã†ã€‚å®‡å®™ã«ã€è‡ªåˆ†ãŒã©ã†æ‰±ã‚ã‚ŒãŸã„ã‹ã€ã‚’å ‚ã€…ã¨å®£è¨€ã—ãŸæ™‚ã€ã“ã®é–¢ä¿‚æ€§ã¯å…¨ãæ–°ã—ã„å½¢ã¸ã¨å†æ§‹ç¯‰ã•ã‚Œã¾ã™ã€‚</p>`;
            else ans += `<p>ä»Šã¯å°‘ã—ç›¸æ‰‹ã¨ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒã™ã‚Œé•ã„ã‚„ã™ã„ã€Œè©¦ç·´ã®æ™‚æœŸã€ã®ã‚ˆã†ã§ã™ã€‚æ„Ÿæƒ…ã«ä»»ã›ã¦è¡Œå‹•ã‚’èµ·ã“ã™ã¨é€†åŠ¹æœã«ãªã‚‹æš—ç¤ºãŒã‚ã‚Šã¾ã™ã€‚ã¾ãšã¯ä¸€åº¦ç«‹ã¡æ­¢ã¾ã‚Šã€è‡ªåˆ†ã®å¿ƒã‚’ç™’ã‚„ã™ã“ã¨ã«å°‚å¿µã—ã¦ãã ã•ã„ã€‚ã‚«ãƒ¼ãƒ‰ã¯ã€åŸ·ç€ã‚’æ‰‹æ”¾ã—ãŸæ™‚ã«ã“ãã€çœŸã®æ„›ãŒå¼•ãå¯„ã›ã‚‰ã‚Œã‚‹ã€ã¨å‘Šã’ã¦ã„ã¾ã™ã€‚</p>`;
        } else if (category === "work") {
            if (!isFutureReversed) ans += `<p>ä»•äº‹ã‚„ã‚­ãƒ£ãƒªã‚¢ã§ç©ã¿é‡ã­ã¦ããŸæˆ‘æ…¢ã¯æ±ºã—ã¦ç„¡é§„ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã¾ã‚‚ãªãè¦–ç•ŒãŒã‚¯ãƒªã‚¢ã«ãªã‚Šã€æ­£å½“ã«è©•ä¾¡ã—ã¦ãã‚Œã‚‹ç’°å¢ƒãŒæ•´ã„ã¾ã™ã€‚ã‚‚ã—æ–°ã—ã„é“ï¼ˆè»¢è·ã‚„ç‹¬ç«‹ãªã©ï¼‰ã‚’è¿·ã£ã¦ã„ã‚‹ãªã‚‰ã€ç›´æ„Ÿã«å¾“ã£ã¦è¸ã¿å‡ºã™ã¹ãã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã™ã€‚å‘¨å›²ã®è©•ä¾¡ã«ç¸›ã‚‰ã‚Œãšã€ã‚ãªãŸãŒæœ¬å½“ã«ãƒ¯ã‚¯ãƒ¯ã‚¯ã™ã‚‹æ–¹å‘ã«èˆµã‚’åˆ‡ã£ã¦ãã ã•ã„ã€‚</p>`;
            else ans += `<p>ç„¦ã‚Šã‹ã‚‰çªç™ºçš„ãªæ±ºæ–­ã‚’ä¸‹ã™ã®ã¯å°‘ã—å¾…ã£ãŸæ–¹ãŒè‰¯ã•ãã†ã§ã™ã€‚ä»Šã¯æ°´é¢ä¸‹ã§ã‚¹ã‚­ãƒ«ã‚¢ãƒƒãƒ—ã‚„æƒ…å ±åé›†ã‚’é€²ã‚ã‚‹ã¹ãæ™‚æœŸã§ã™ã€‚æ™‚æœŸãŒæ¥ã‚Œã°é©šãã»ã©ã‚¹ãƒ ãƒ¼ã‚ºã«æ¬¡ã®æ‰‰ãŒé–‹ãã¾ã™ã€‚ã‚¿ãƒ­ãƒƒãƒˆã¯ã€ã‚ãªãŸã¯ã™ã§ã«å¿…è¦ãªã‚‚ã®ã‚’ã™ã¹ã¦æŒã£ã¦ã„ã‚‹ã€ã¨èƒŒä¸­ã‚’æŠ¼ã—ã¦ã„ã¾ã™ã€‚</p>`;
        } else {
            if (!isFutureReversed) ans += `<p>æš—ã„ãƒˆãƒ³ãƒãƒ«ã®å‡ºå£ã¯ã‚‚ã†ã™ããã“ã§ã™ã€‚ã‚ãªãŸãŒä»Šæ„Ÿã˜ã¦ã„ã‚‹è‹¦ã—ã¿ã¯ã€æ¬¡ã®å¤§ããªã‚¹ãƒ†ãƒ¼ã‚¸ã¸é€²ã‚€ãŸã‚ã®ã€Œæˆé•·ç—›ã€ã«éãã¾ã›ã‚“ã€‚è‡ªåˆ†ã®ç›´æ„Ÿã‚’ä¿¡ã˜ã¦é€²ã‚“ã§ãã ã•ã„ã€‚ã‚ã‚Šã®ã¾ã¾ã®ã‚ãªãŸã§ã„ã‚‹ã“ã¨ãŒã€æœ€é«˜ã®èª¿å’Œã‚’ç”Ÿã¿å‡ºã—ã¾ã™ã€‚</p>`;
            else ans += `<p>ã‚ãªãŸã¯ä»Šã€ä¸€äººã§å…¨ã¦ã‚’æŠ±ãˆè¾¼ã‚‚ã†ã¨ã—ã™ãã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚çŠ¶æ³ã‚’ç„¡ç†ã«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã—ã‚ˆã†ã¨ã™ã‚‹ã®ã‚’ã‚„ã‚ã€ä¸€åº¦æµã‚Œã«èº«ã‚’ä»»ã›ã¦ã¿ã¦ãã ã•ã„ã€‚ä¸è¦ãªç¸ã¯è‡ªç„¶ã¨é›¢ã‚Œã¦ã„ãã€æœ¬å½“ã«å¿…è¦ãªã‚‚ã®ã ã‘ãŒã‚ãªãŸã®æ‰‹ã®ä¸­ã«æ®‹ã‚Šã¾ã™ã€‚</p>`;
        }
        return ans;
    }

    function startTarotOracle() {
        try {
            const rawName = document.getElementById("name4").value.trim(); 
            const name = escapeHTML(rawName);
            const dob = document.getElementById("dob4").value; 
            const rawWorry = document.getElementById("worry4").value.trim();
            const worry = escapeHTML(rawWorry); 

            if (!isValidDob(dob)) return;
            if (!name) return alert("ãŠåå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
            if (!worry) return alert("é­‚ã®æ³¢é•·ã‚’åˆã‚ã›ã‚‹ãŸã‚ã€å…·ä½“çš„ãªæ‚©ã¿ã‚’å°‘ã—ã§ã‚‚ã”å…¥åŠ›ãã ã•ã„ã€‚");

            showLoading("SHUFFLING TAROT DECK...", "var(--accent-tarot)", false, () => {
                const seedStr = name + dob + worry + "tarot_ultimate_final_v6"; const random = getSeededRandom(seedStr); 
                let deck = [...majorArcana]; let drawnCards = [];
                for(let i=0; i<3; i++) { let idx = Math.floor(random() * deck.length); let card = deck.splice(idx, 1)[0]; drawnCards.push({ card: card, isReversed: random() > 0.6 }); }

                document.getElementById("resName4").innerText = name + " æ§˜";

                for(let i=0; i<3; i++) {
                    const c = drawnCards[i]; const pos = c.isReversed ? 'é€†ä½ç½®' : 'æ­£ä½ç½®'; const meaning = c.isReversed ? c.card.r : c.card.p;
                    document.getElementById(`tcNum${i+1}`).innerText = c.card.num; document.getElementById(`tcName${i+1}`).innerHTML = `${c.card.ja}<br><span style="font-size:9px; opacity:0.7;">${c.card.en}</span>`;
                    const posEl = document.getElementById(`tcPos${i+1}`); posEl.className = `t-front-pos ${c.isReversed ? 't-pos-rev' : 't-pos-up'}`; posEl.innerText = pos;

                    let text = "";
                    if (i === 0) text = `<p>ã€éå»ãƒ»æ ¹æœ¬åŸå› ã€‘ã®é ˜åŸŸã«å±•é–‹ã•ã‚ŒãŸã®ã¯ã€${c.card.ja}ã€ã®${pos}ã§ã™ã€‚</p><p>ã“ã®ã‚«ãƒ¼ãƒ‰ã¯<span class='tarot-highlight'>ã€${meaning}ã€‘</span>ã¨ã„ã†å¼·çƒˆãªæ³¢å‹•ã‚’æ”¾ã£ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¾ã§ã‚ãªãŸãŒç„¡æ„è­˜ã®ã†ã¡ã«æŠ±ãˆã¦ããŸæ„Ÿæƒ…ã‚„ã€äººçŸ¥ã‚ŒãšèƒŒè² ã£ã¦ããŸé‡è·ãŒã€ä»Šã®æ‚©ã¿ã®ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã‚’ä½œã£ã¦ã„ã¾ã™ã€‚</p>`;
                    else if (i === 1) text = `<p>ã€ç¾åœ¨ã®çŠ¶æ³ã¨æ·±å±¤å¿ƒç†ã€‘ã‚’æ˜ ã—å‡ºã™ä½ç½®ã«ã€${c.card.ja}ã€ã®${pos}ãŒç¾ã‚Œã¾ã—ãŸã€‚</p><p>ã¾ã•ã«ä»Šã€ã‚ãªãŸã¯<span class='tarot-highlight'>ã€${meaning}ã€‘</span>ã¨ã„ã†å®‡å®™ã®å¼•åŠ›ã«åŒ…ã¾ã‚Œã¦ã„ã¾ã™ã€‚è¡¨é¢çš„ã«ã¯ã©ã†å–ã‚Šç¹•ã£ã¦ã„ã¦ã‚‚ã€ã‚ãªãŸã®é­‚ã¯ä»Šã“ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼çŠ¶æ…‹ã®åªä¸­ã«ã‚ã‚Šã¾ã™ã€‚</p>`;
                    else text = `<p>ã‚ãªãŸãŒå–ã‚‹ã¹ãè¡Œå‹•ã®ã€æœ€çµ‚çµæœãƒ»æœªæ¥ã€‘ã‚’ç¤ºã™ä½ç½®ã«å°ã‹ã‚ŒãŸã®ã¯ã€${c.card.ja}ã€ã®${pos}ã§ã™ã€‚</p><p>ã“ã®ã‚«ãƒ¼ãƒ‰ãŒæŒ‡ã—ç¤ºã™<span class='tarot-highlight'>ã€${meaning}ã€‘</span>ã¨ã„ã†æš—ç¤ºã¯ã€ä»Šå¾Œã®ã‚ãªãŸã«è¨ªã‚Œã‚‹æ±ºå®šçš„ãªå‡ºæ¥äº‹ã‚’äºˆå‘Šã—ã¦ã„ã¾ã™ã€‚</p>`;
                    document.getElementById(i===0 ? "resT_past" : i===1 ? "resT_present" : "resT_future").innerHTML = text;
                }

                let adviceMsg = generateWorryAnswer(worry, drawnCards[2].card, drawnCards[2].isReversed);
                document.getElementById("tarotFinalMsg").innerHTML = adviceMsg;
                
                shareTextCache['tarot'] = `ğŸƒã€æ˜Ÿå±‘ã®ç¥è¨—ã€‘æ·±å±¤ã‚¿ãƒ­ãƒƒãƒˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã§å ã„ã¾ã—ãŸã€‚\næœªæ¥ã¸ã®å•“ç¤ºã¨ã—ã¦å¼•ã‹ã‚ŒãŸã‚«ãƒ¼ãƒ‰ã¯ã€${drawnCards[2].card.ja} (${drawnCards[2].isReversed ? 'é€†ä½ç½®' : 'æ­£ä½ç½®'})ã€ï¼\n`;

                applyPaywallState();
                document.getElementById("res-tarot").classList.add("active");
                setTimeout(() => document.getElementById("tCard1").classList.add("flipped"), 600); setTimeout(() => document.getElementById("tCard2").classList.add("flipped"), 1400); setTimeout(() => document.getElementById("tCard3").classList.add("flipped"), 2200);
            });
        } catch(e) { console.error(e); alert("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å…¥åŠ›å†…å®¹ã‚’ã”ç¢ºèªãã ã•ã„ã€‚"); }
    }
</script>
</body>
</html>
